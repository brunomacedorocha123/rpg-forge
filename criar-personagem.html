<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Criar Personagem - Role 3d6</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style-atributos.css">
    <style>
    /* ===== ESTILOS BASE ===== */
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        background-color: #0a0a0a;
        color: #FFFFFF;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        min-height: 100vh;
        overflow-x: hidden;
    }

    /* ===== CABE√áALHO COMPACTO ===== */
    .main-header {
        background: rgba(15, 15, 15, 0.95);
        padding: 12px 25px;
        border-bottom: 1px solid #D4AF37;
        box-shadow: 0 2px 15px rgba(0, 0, 0, 0.6);
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 1000;
        display: flex;
        justify-content: space-between;
        align-items: center;
        height: 60px;
    }

    .logo-section {
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .logo {
        height: 36px;
        filter: drop-shadow(0 0 8px rgba(212, 175, 55, 0.7));
    }

    .logo-text {
        font-size: 1.4rem;
        font-weight: 700;
        background: linear-gradient(90deg, #D4AF37, #FFD700);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    /* ===== CONTROLES DO CABE√áALHO ===== */
    .header-controls {
        display: flex;
        align-items: center;
        gap: 15px;
    }

    .header-info {
        display: flex;
        gap: 15px;
    }

    .info-box {
        background: rgba(30, 30, 30, 0.9);
        border: 1px solid rgba(212, 175, 55, 0.3);
        border-radius: 8px;
        padding: 8px 15px;
        text-align: center;
        min-width: 140px;
        position: relative;
    }

    .info-box.editable {
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .info-box.editable:hover {
        border-color: #FFD700;
        background: rgba(30, 30, 30, 0.95);
    }

    .info-label {
        font-size: 0.75rem;
        color: #FFD700;
        margin-bottom: 3px;
        font-weight: 600;
    }

    .info-value {
        font-size: 1.4rem;
        font-weight: 700;
        color: white;
        cursor: text;
    }

    .info-sublabel {
        font-size: 0.7rem;
        color: #aaa;
        margin-top: 3px;
    }

    .info-edit-btn {
        position: absolute;
        right: 5px;
        top: 5px;
        background: none;
        border: none;
        color: rgba(212, 175, 55, 0.5);
        cursor: pointer;
        font-size: 0.8rem;
        padding: 2px;
        opacity: 0;
        transition: opacity 0.2s ease;
    }

    .info-box:hover .info-edit-btn {
        opacity: 1;
    }

    .btn-header {
        background: linear-gradient(45deg, #4CAF50, #2E7D32);
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 6px;
        font-weight: 600;
        font-size: 0.9rem;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 6px;
        transition: all 0.2s ease;
        height: 36px;
    }

    .btn-header:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
    }

    .btn-header.save {
        background: linear-gradient(45deg, #2196F3, #0D47A1);
    }

    .btn-header.clear {
        background: linear-gradient(45deg, #f44336, #b71c1c);
    }

    .header-buttons {
        display: flex;
        gap: 10px;
    }

    /* ===== CONTE√öDO PRINCIPAL ===== */
    .main-content {
        margin-top: 80px;
        padding: 20px 30px 30px;
        min-height: calc(100vh - 80px);
    }

    /* ===== SISTEMA DE ABAS ===== */
    .tabs-container {
        background: rgba(20, 20, 20, 0.9);
        border-radius: 12px;
        border: 1px solid rgba(212, 175, 55, 0.2);
        margin-bottom: 25px;
        overflow: hidden;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
    }

    .tabs-header {
        display: flex;
        background: rgba(25, 25, 25, 0.95);
        border-bottom: 1px solid rgba(212, 175, 55, 0.2);
        overflow-x: auto;
        scrollbar-width: none;
    }

    .tabs-header::-webkit-scrollbar {
        display: none;
    }

    .tab-btn {
        background: transparent;
        border: none;
        color: #aaa;
        padding: 14px 20px;
        font-size: 0.95rem;
        font-weight: 600;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        white-space: nowrap;
        transition: all 0.2s ease;
        position: relative;
    }

    .tab-btn:hover {
        color: #FFD700;
        background: rgba(212, 175, 55, 0.1);
    }

    .tab-btn.active {
        color: #FFD700;
        background: rgba(212, 175, 55, 0.15);
    }

    .tab-btn.active::after {
        content: '';
        position: absolute;
        bottom: -1px;
        left: 0;
        right: 0;
        height: 2px;
        background: linear-gradient(90deg, #D4AF37, #FFD700);
    }

    .tab-content {
        padding: 25px;
        min-height: 500px;
    }

    .tab-pane {
        display: none;
        animation: fadeIn 0.3s ease;
    }

    .tab-pane.active {
        display: block;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }

    /* ===== DASHBOARD ===== */
    .dashboard-container {
        display: flex;
        flex-direction: column;
        gap: 20px;
    }

    .dashboard-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
    }

    @media (max-width: 1024px) {
        .dashboard-grid {
            grid-template-columns: 1fr;
        }
    }

    /* ===== CARDS DA DASHBOARD ===== */
    .dashboard-card {
        background: rgba(25, 25, 25, 0.9);
        border: 1px solid rgba(212, 175, 55, 0.2);
        border-radius: 10px;
        overflow: hidden;
        transition: all 0.3s ease;
    }

    .dashboard-card:hover {
        border-color: rgba(212, 175, 55, 0.4);
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
    }

    .dashboard-card.card-wide {
        grid-column: 1 / -1;
    }

    .dashboard-card.card-identity {
        border-color: rgba(76, 175, 80, 0.3);
    }

    .dashboard-card.card-summary {
        border-color: rgba(33, 150, 243, 0.3);
    }

    .dashboard-card.card-reaction {
        border-color: rgba(255, 193, 7, 0.3);
    }

    /* ===== CABE√áALHO DOS CARDS ===== */
    .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px 20px;
        background: rgba(30, 30, 30, 0.95);
        border-bottom: 1px solid rgba(212, 175, 55, 0.1);
    }

    .card-title {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .card-title h3 {
        font-size: 1.1rem;
        color: #FFD700;
        margin: 0;
        font-weight: 600;
    }

    .card-title i {
        color: #FFD700;
        font-size: 1.2rem;
    }

    .card-status {
        font-size: 0.8rem;
        font-weight: 600;
        padding: 4px 10px;
        border-radius: 20px;
        background: rgba(255, 193, 7, 0.15);
        color: #FFC107;
    }

    .card-badge {
        font-size: 0.8rem;
        font-weight: 600;
        padding: 4px 10px;
        border-radius: 20px;
        background: rgba(33, 150, 243, 0.15);
        color: #2196F3;
    }

    /* ===== CONTE√öDO DOS CARDS ===== */
    .card-content {
        padding: 20px;
    }

    .card-footer {
        padding: 15px 20px;
        border-top: 1px dashed rgba(212, 175, 55, 0.1);
        background: rgba(20, 20, 20, 0.8);
    }

    .card-footer small {
        font-size: 0.8rem;
        color: #888;
        font-style: italic;
    }

    /* ===== FORMUL√ÅRIOS ===== */
    .form-group {
        margin-bottom: 20px;
    }

    .form-group label {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 0.9rem;
        color: #FFD700;
        margin-bottom: 8px;
        font-weight: 600;
    }

    .form-group label i {
        font-size: 0.9rem;
    }

    .form-input {
        width: 100%;
        padding: 10px 12px;
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(212, 175, 55, 0.2);
        border-radius: 6px;
        color: white;
        font-size: 0.95rem;
        transition: all 0.3s ease;
    }

    .form-input:focus {
        outline: none;
        border-color: #FFD700;
        box-shadow: 0 0 0 2px rgba(212, 175, 55, 0.1);
    }

    .form-select {
        width: 100%;
        padding: 10px 12px;
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(212, 175, 55, 0.2);
        border-radius: 6px;
        color: white;
        font-size: 0.95rem;
        cursor: pointer;
    }

    .form-select:focus {
        outline: none;
        border-color: #FFD700;
    }

    .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        margin-bottom: 15px;
    }

    @media (max-width: 768px) {
        .form-row {
            grid-template-columns: 1fr;
            gap: 15px;
        }
    }

    /* ===== INPUT COM A√á√ÉO ===== */
    .input-with-action {
        display: flex;
        gap: 10px;
    }

    .input-with-action .form-input {
        flex: 1;
    }

    .btn-action {
        background: rgba(212, 175, 55, 0.2);
        border: 1px solid rgba(212, 175, 55, 0.3);
        color: #FFD700;
        padding: 0 15px;
        border-radius: 6px;
        font-size: 0.9rem;
        font-weight: 600;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 5px;
        transition: all 0.2s ease;
        white-space: nowrap;
    }

    .btn-action:hover {
        background: rgba(212, 175, 55, 0.3);
    }

    /* ===== BOT√ïES MODAIS ===== */
    .btn-modal {
        background: linear-gradient(45deg, rgba(212, 175, 55, 0.8), rgba(212, 175, 55, 0.6));
        border: 1px solid rgba(212, 175, 55, 0.4);
        color: #0a0a0a;
        padding: 8px 15px;
        border-radius: 6px;
        font-size: 0.9rem;
        font-weight: 600;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 6px;
        transition: all 0.2s ease;
    }

    .btn-modal:hover {
        background: linear-gradient(45deg, rgba(212, 175, 55, 1), rgba(212, 175, 55, 0.8));
        transform: translateY(-1px);
    }

    /* ===== IMAGEM DO PERSONAGEM ===== */
    .imagem-personagem-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 15px;
        margin: 20px 0;
    }

    .imagem-placeholder {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        background: rgba(212, 175, 55, 0.1);
        border: 2px dashed rgba(212, 175, 55, 0.3);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
        overflow: hidden;
    }

    .imagem-placeholder:hover {
        border-color: #FFD700;
        background: rgba(212, 175, 55, 0.15);
    }

    .imagem-placeholder i {
        font-size: 3rem;
        color: rgba(212, 175, 55, 0.5);
        margin-bottom: 10px;
    }

    .imagem-placeholder p {
        color: #888;
        font-size: 0.9rem;
    }

    .imagem-preview {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        overflow: hidden;
        border: 3px solid #FFD700;
        box-shadow: 0 0 20px rgba(212, 175, 55, 0.3);
    }

    .imagem-preview img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .botoes-imagem {
        display: flex;
        gap: 10px;
        margin-top: 10px;
    }

    .btn-imagem {
        background: rgba(212, 175, 55, 0.2);
        border: 1px solid rgba(212, 175, 55, 0.3);
        color: #FFD700;
        padding: 8px 15px;
        border-radius: 6px;
        font-size: 0.9rem;
        font-weight: 600;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 6px;
        transition: all 0.2s ease;
    }

    .btn-imagem:hover {
        background: rgba(212, 175, 55, 0.3);
        transform: translateY(-1px);
    }

    .btn-imagem.remover {
        background: rgba(231, 76, 60, 0.2);
        border-color: rgba(231, 76, 60, 0.3);
        color: #e74c3c;
    }

    .btn-imagem.remover:hover {
        background: rgba(231, 76, 60, 0.3);
    }

    /* ===== APAR√äNCIA F√çSICA ===== */
    .appearance-summary {
        background: rgba(0, 0, 0, 0.2);
        border-radius: 8px;
        padding: 15px;
        border: 1px solid rgba(212, 175, 55, 0.1);
    }

    .appearance-status {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 15px;
    }

    .appearance-icon {
        background: rgba(212, 175, 55, 0.1);
        width: 50px;
        height: 50px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        color: #FFD700;
        border: 1px solid rgba(212, 175, 55, 0.2);
    }

    .appearance-info h4 {
        font-size: 1rem;
        color: white;
        margin: 0 0 5px 0;
    }

    .appearance-info p {
        font-size: 0.9rem;
        color: #aaa;
        margin: 0 0 10px 0;
    }

    .appearance-modifiers {
        display: flex;
        gap: 8px;
    }

    .modifier-badge {
        font-size: 0.75rem;
        padding: 3px 8px;
        border-radius: 12px;
        background: rgba(33, 150, 243, 0.15);
        color: #2196F3;
        font-weight: 600;
        border: 1px solid rgba(33, 150, 243, 0.3);
    }

    .physical-summary {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 10px;
    }

    .physical-item {
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(212, 175, 55, 0.1);
        border-radius: 6px;
        padding: 10px;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .physical-item i {
        color: #FFD700;
        font-size: 1rem;
    }

    .physical-item small {
        display: block;
        font-size: 0.7rem;
        color: #888;
        margin-bottom: 2px;
    }

    .physical-item strong {
        font-size: 0.9rem;
        color: white;
        font-weight: 600;
    }

    /* ===== IDIOMAS ===== */
    .language-summary {
        background: rgba(0, 0, 0, 0.2);
        border-radius: 8px;
        padding: 15px;
        border: 1px solid rgba(212, 175, 55, 0.1);
    }

    .language-status {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 15px;
    }

    .language-icon {
        background: rgba(33, 150, 243, 0.1);
        width: 50px;
        height: 50px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        color: #2196F3;
        border: 1px solid rgba(33, 150, 243, 0.2);
    }

    .language-info h4 {
        font-size: 0.9rem;
        color: white;
        margin: 0 0 5px 0;
    }

    .language-info p {
        font-size: 0.9rem;
        color: #aaa;
        margin: 0 0 10px 0;
    }

    .language-modifiers {
        display: flex;
        gap: 8px;
    }

    .language-list {
        max-height: 150px;
        overflow-y: auto;
    }

    .empty-state {
        text-align: center;
        padding: 20px;
        color: #666;
    }

    .empty-state i {
        font-size: 2rem;
        margin-bottom: 10px;
        color: #444;
    }

    .empty-state p {
        font-size: 0.9rem;
        margin: 0;
    }

    /* ===== RIQUEZA ===== */
    .wealth-summary {
        background: rgba(0, 0, 0, 0.2);
        border-radius: 8px;
        padding: 15px;
        border: 1px solid rgba(212, 175, 55, 0.1);
    }

    .wealth-status {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 20px;
    }

    .wealth-icon {
        background: rgba(255, 193, 7, 0.1);
        width: 50px;
        height: 50px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        color: #FFC107;
        border: 1px solid rgba(255, 193, 7, 0.2);
    }

    .wealth-info h4 {
        font-size: 1rem;
        color: white;
        margin: 0 0 5px 0;
    }

    .wealth-info p {
        font-size: 0.9rem;
        color: #aaa;
        margin: 0 0 10px 0;
    }

    .wealth-modifiers {
        display: flex;
        gap: 8px;
    }

    .wealth-details {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 15px;
    }

    .wealth-item {
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(212, 175, 55, 0.1);
        border-radius: 6px;
        padding: 12px;
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .wealth-item i {
        color: #FFD700;
        font-size: 1.2rem;
    }

    .wealth-item small {
        display: block;
        font-size: 0.7rem;
        color: #888;
        margin-bottom: 3px;
    }

    .wealth-item strong {
        font-size: 1rem;
        color: white;
        font-weight: 600;
    }

    /* ===== RESUMO DE GASTOS ===== */
    .expenses-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 12px;
        margin-bottom: 20px;
    }

    .expense-item {
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(212, 175, 55, 0.1);
        border-radius: 6px;
        padding: 12px;
    }

    .expense-label {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 0.85rem;
        color: #aaa;
        margin-bottom: 8px;
    }

    .expense-label i {
        color: #FFD700;
        font-size: 0.9rem;
    }

    .expense-value {
        font-size: 1.3rem;
        font-weight: 700;
        color: white;
        margin-bottom: 8px;
    }

    .expense-progress {
        height: 4px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 2px;
        overflow: hidden;
    }

    .progress-bar {
        height: 100%;
        background: linear-gradient(90deg, #D4AF37, #FFD700);
        border-radius: 2px;
        transition: width 0.5s ease;
    }

    .expenses-total {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        background: rgba(212, 175, 55, 0.1);
        padding: 15px;
        border-radius: 8px;
        border: 1px solid rgba(212, 175, 55, 0.2);
    }

    .total-item {
        text-align: center;
    }

    .total-label {
        font-size: 0.8rem;
        color: #FFD700;
        margin-bottom: 5px;
        font-weight: 600;
    }

    .total-value {
        font-size: 1.5rem;
        font-weight: 800;
        color: white;
    }

    .total-value.available {
        color: #4CAF50;
    }

    /* ===== SISTEMA DE REA√á√ÉO ===== */
    .reaction-list {
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    .reaction-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 15px;
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(212, 175, 55, 0.1);
        border-radius: 6px;
    }

    .reaction-item.total {
        background: rgba(212, 175, 55, 0.1);
        border-color: rgba(212, 175, 55, 0.3);
    }

    .reaction-label {
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 0.9rem;
        color: white;
        font-weight: 600;
    }

    .reaction-label i {
        color: #FFD700;
    }

    .reaction-value {
        font-size: 1rem;
        font-weight: 700;
        background: rgba(255, 255, 255, 0.1);
        color: #FFD700;
        padding: 5px 12px;
        border-radius: 15px;
        min-width: 50px;
        text-align: center;
    }

    .reaction-value.total {
        background: #FFD700;
        color: #0a0a0a;
    }

    /* ===== MODAIS ===== */
    .dashboard-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.85);
        z-index: 2000;
        justify-content: center;
        align-items: center;
        padding: 20px;
        animation: modalFadeIn 0.3s ease;
    }

    @keyframes modalFadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }

    .modal-content {
        background: rgba(25, 25, 25, 0.95);
        border: 1px solid rgba(212, 175, 55, 0.3);
        border-radius: 12px;
        width: 100%;
        max-width: 800px;
        max-height: 90vh;
        overflow-y: auto;
        animation: modalSlideUp 0.4s ease;
    }

    @keyframes modalSlideUp {
        from { transform: translateY(30px); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
    }

    .modal-content.large {
        max-width: 1000px;
    }

    .modal-header {
        padding: 20px 25px;
        border-bottom: 1px solid rgba(212, 175, 55, 0.2);
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .modal-header h3 {
        font-size: 1.3rem;
        color: #FFD700;
        margin: 0;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .modal-close {
        background: none;
        border: none;
        font-size: 1.8rem;
        color: #aaa;
        cursor: pointer;
        padding: 0;
        width: 30px;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        transition: all 0.2s ease;
    }

    .modal-close:hover {
        background: rgba(255, 255, 255, 0.1);
        color: #FFD700;
    }

    .modal-body {
        padding: 25px;
    }

    .modal-footer {
        padding: 20px 25px;
        border-top: 1px solid rgba(212, 175, 55, 0.2);
        display: flex;
        justify-content: flex-end;
        gap: 10px;
    }

    .btn-primary {
        background: linear-gradient(45deg, #D4AF37, #FFD700);
        color: #0a0a0a;
        border: none;
        padding: 10px 20px;
        border-radius: 6px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .btn-primary:hover {
        transform: translateY(-1px);
        box-shadow: 0 5px 15px rgba(212, 175, 55, 0.3);
    }

    .btn-secondary {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(212, 175, 55, 0.3);
        color: #FFD700;
        padding: 10px 20px;
        border-radius: 6px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .btn-secondary:hover {
        background: rgba(212, 175, 55, 0.1);
    }

    .modal-loading {
        text-align: center;
        padding: 40px 20px;
    }

    .modal-loading i {
        font-size: 2.5rem;
        color: #FFD700;
        margin-bottom: 15px;
    }

    .modal-loading p {
        color: #aaa;
        margin: 0;
    }

    /* ===== CONTE√öDO DOS MODAIS ===== */
    .modal-section {
        margin-bottom: 25px;
    }

    .modal-section h4 {
        color: #FFD700;
        margin-bottom: 15px;
        font-size: 1.1rem;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .niveis-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
    }

    .nivel-item {
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(212, 175, 55, 0.1);
        border-radius: 8px;
        padding: 15px;
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
    }

    .nivel-item:hover {
        border-color: #FFD700;
        background: rgba(212, 175, 55, 0.1);
    }

    .nivel-item.selecionado {
        border-color: #FFD700;
        background: rgba(212, 175, 55, 0.15);
    }

    .nivel-item.selecionado::after {
        content: '‚úì';
        position: absolute;
        top: 10px;
        right: 10px;
        background: #FFD700;
        color: #0a0a0a;
        width: 24px;
        height: 24px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
    }

    .nivel-header {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 8px;
    }

    .nivel-header i {
        font-size: 1.2rem;
    }

    .nivel-header h5 {
        font-size: 1rem;
        margin: 0;
        color: white;
    }

    .nivel-pontos {
        font-size: 0.9rem;
        font-weight: bold;
        margin-bottom: 5px;
    }

    .nivel-descricao {
        font-size: 0.85rem;
        color: #aaa;
        line-height: 1.4;
    }

    /* ===== LISTA DE ITEMS ===== */
    .lista-itens {
        max-height: 300px;
        overflow-y: auto;
        border: 1px solid rgba(212, 175, 55, 0.1);
        border-radius: 8px;
        padding: 10px;
        background: rgba(0, 0, 0, 0.2);
    }

    .item-lista {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px;
        border-bottom: 1px solid rgba(212, 175, 55, 0.1);
    }

    .item-lista:last-child {
        border-bottom: none;
    }

    .item-info h5 {
        font-size: 0.95rem;
        margin: 0 0 4px 0;
        color: white;
    }

    .item-info p {
        font-size: 0.8rem;
        margin: 0;
        color: #aaa;
    }

    .item-acoes {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .item-pontos {
        font-size: 0.9rem;
        font-weight: bold;
        color: #FFD700;
    }

    .btn-remover {
        background: rgba(231, 76, 60, 0.2);
        border: 1px solid rgba(231, 76, 60, 0.3);
        color: #e74c3c;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 0.8rem;
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .btn-remover:hover {
        background: rgba(231, 76, 60, 0.3);
    }

    /* ===== FORMUL√ÅRIO ADICIONAR ===== */
    .form-adicionar {
        background: rgba(0, 0, 0, 0.2);
        border: 1px solid rgba(212, 175, 55, 0.1);
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 20px;
    }

    .form-adicionar .form-row {
        margin-bottom: 0;
    }

    /* ===== PONTOS NEGATIVOS ===== */
    .pontos-negativo {
        color: #e74c3c !important;
    }

    .pontos-positivo {
        color: #27ae60 !important;
    }

    .custo-negativo {
        background: rgba(231, 76, 60, 0.15) !important;
        border-color: rgba(231, 76, 60, 0.3) !important;
        color: #e74c3c !important;
    }

    .custo-positivo {
        background: rgba(46, 204, 113, 0.15) !important;
        border-color: rgba(46, 204, 113, 0.3) !important;
        color: #2ecc71 !important;
    }

    /* ===== LIMITE DE PONTOS ===== */
    .limite-excedido {
        border-color: #e74c3c !important;
        background: rgba(231, 76, 60, 0.1) !important;
    }

    .limite-alerta {
        border-color: #FFC107 !important;
        background: rgba(255, 193, 7, 0.1) !important;
    }

    /* ===== RODAP√â ===== */
    .main-footer {
        background: rgba(10, 10, 10, 0.95);
        border-top: 1px solid rgba(212, 175, 55, 0.2);
        padding: 15px;
        text-align: center;
        color: #666;
        font-size: 0.85rem;
    }

    /* ===== DADOS DECORATIVOS ===== */
    .floating-dice {
        position: fixed;
        font-size: 1.5rem;
        color: rgba(212, 175, 55, 0.08);
        z-index: -1;
        animation: float 25s infinite linear;
        pointer-events: none;
    }

    @keyframes float {
        0% { transform: translate(0, 0) rotate(0deg); }
        25% { transform: translate(80px, 40px) rotate(90deg); }
        50% { transform: translate(40px, 80px) rotate(180deg); }
        75% { transform: translate(-40px, 40px) rotate(270deg); }
        100% { transform: translate(0, 0) rotate(360deg); }
    }

    /* ===== SCROLLBAR ===== */
    ::-webkit-scrollbar {
        width: 8px;
    }

    ::-webkit-scrollbar-track {
        background: #111111;
    }

    ::-webkit-scrollbar-thumb {
        background: linear-gradient(to bottom, #D4AF37, #FFD700);
        border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(to bottom, #FFD700, #D4AF37);
    }

    /* ===== BOT√ÉO LOGOUT ===== */
    .btn-header.logout {
        background: linear-gradient(45deg, #ff4444, #cc0000);
    }

    /* ===== RESPONSIVIDADE ===== */
    @media (max-width: 1024px) {
        .main-header {
            padding: 10px 20px;
            height: 55px;
        }
        
        .logo {
            height: 32px;
        }
        
        .logo-text {
            font-size: 1.2rem;
        }
        
        .info-box {
            min-width: 120px;
            padding: 6px 12px;
        }
        
        .info-value {
            font-size: 1.2rem;
        }
        
        .btn-header {
            padding: 6px 12px;
            font-size: 0.85rem;
            height: 32px;
        }
        
        .main-content {
            margin-top: 75px;
            padding: 15px 25px 25px;
        }
    }

    @media (max-width: 768px) {
        .main-header {
            flex-direction: row;
            height: auto;
            min-height: 60px;
            padding: 10px 15px;
            gap: 10px;
        }
        
        .logo-section {
            flex-direction: row;
            text-align: left;
        }
        
        .logo {
            height: 30px;
        }
        
        .logo-text {
            font-size: 1.1rem;
        }
        
        .header-controls {
            flex-direction: column;
            align-items: flex-end;
            gap: 8px;
        }
        
        .header-info {
            gap: 10px;
        }
        
        .info-box {
            min-width: 110px;
            padding: 5px 10px;
        }
        
        .info-label {
            font-size: 0.7rem;
        }
        
        .info-value {
            font-size: 1.1rem;
        }
        
        .header-buttons {
            gap: 6px;
        }
        
        .btn-header {
            padding: 5px 10px;
            font-size: 0.8rem;
            height: 30px;
        }
        
        .main-content {
            margin-top: 90px;
            padding: 15px 20px 20px;
        }
        
        .tab-btn {
            padding: 12px 15px;
            font-size: 0.9rem;
        }
        
        .tab-content {
            padding: 20px;
            min-height: 400px;
        }
    }

    @media (max-width: 480px) {
        .main-header {
            padding: 8px 12px;
            gap: 8px;
        }
        
        .logo {
            height: 26px;
        }
        
        .logo-text {
            font-size: 1rem;
            letter-spacing: 0.5px;
        }
        
        .header-info {
            flex-direction: column;
            gap: 5px;
        }
        
        .info-box {
            min-width: 100px;
            padding: 4px 8px;
        }
        
        .info-value {
            font-size: 1rem;
        }
        
        .header-buttons {
            flex-wrap: wrap;
            justify-content: flex-end;
        }
        
        .btn-header {
            padding: 4px 8px;
            font-size: 0.75rem;
            height: 28px;
        }
        
        .main-content {
            margin-top: 110px;
            padding: 10px 15px 15px;
        }
        
        .tabs-header {
            flex-wrap: nowrap;
            overflow-x: auto;
        }
        
        .tab-btn {
            padding: 10px 12px;
            font-size: 0.85rem;
            min-width: auto;
            flex-shrink: 0;
        }
        
        .tab-content {
            padding: 15px;
            min-height: 350px;
        }
        
        .main-footer {
            padding: 12px;
            font-size: 0.8rem;
        }
    }

    @media (max-width: 360px) {
        .logo-text {
            font-size: 0.9rem;
        }
        
        .info-box {
            min-width: 90px;
        }
        
        .info-value {
            font-size: 0.9rem;
        }
        
        .btn-header span {
            display: none;
        }
        
        .btn-header i {
            margin: 0;
        }
        
        .tab-btn span {
            display: none;
        }
        
        .tab-btn i {
            margin: 0;
            font-size: 1rem;
        }
    }
    </style>
</head>
<body>
    <!-- DADOS DECORATIVOS -->
    <div class="floating-dice" style="top: 15%; left: 5%;">üé≤</div>
    <div class="floating-dice" style="top: 25%; right: 8%;">‚öîÔ∏è</div>
    <div class="floating-dice" style="bottom: 20%; left: 10%;">üè∞</div>
    <div class="floating-dice" style="bottom: 15%; right: 5%;">üõ°Ô∏è</div>

    <!-- CABE√áALHO -->
    <header class="main-header">
        <div class="logo-section">
            <img src="logorole3d6.png" alt="Logo Role 3d6" class="logo">
            <div class="logo-text">Criar Personagem</div>
        </div>
        
        <div class="header-controls">
            <div class="header-info">
                <div class="info-box editable" id="info-box-pontos">
                    <button class="info-edit-btn" onclick="editarValor('pontos')">
                        <i class="fas fa-edit"></i>
                    </button>
                    <div class="info-label">Pontos</div>
                    <div class="info-value" id="pontos-disponiveis" onclick="editarValor('pontos')">150</div>
                    <div class="info-sublabel" id="limites-info">Desv ‚â§ -112 | Pec ‚â§ 30</div>
                </div>
                <div class="info-box" id="info-box-desvantagens">
                    <button class="info-edit-btn" onclick="editarValor('desvantagens')">
                        <i class="fas fa-edit"></i>
                    </button>
                    <div class="info-label">Limite Desv</div>
                    <div class="info-value" id="limite-desvantagens" onclick="editarValor('desvantagens')">-112</div>
                    <div class="info-sublabel">75% dos pontos</div>
                </div>
                <div class="info-box editable" id="info-box-dinheiro">
                    <button class="info-edit-btn" onclick="editarValor('dinheiro')">
                        <i class="fas fa-edit"></i>
                    </button>
                    <div class="info-label">Dinheiro</div>
                    <div class="info-value" id="dinheiro-pc" onclick="editarValor('dinheiro')">$ 1.000</div>
                </div>
            </div>
            
            <div class="header-buttons">
                <button class="btn-header save" id="btnSalvar">
                    <i class="fas fa-save"></i> Salvar
                </button>
                <button class="btn-header" id="btnEditar">
                    <i class="fas fa-edit"></i> Editar
                </button>
                <button class="btn-header clear" id="btnLimpar">
                    <i class="fas fa-broom"></i> Limpar
                </button>
                <button class="btn-header logout" onclick="fazerLogout()">
                    <i class="fas fa-sign-out-alt"></i> Sair
                </button>
            </div>
        </div>
    </header>

    <!-- CONTE√öDO PRINCIPAL -->
    <main class="main-content">
        <div class="tabs-container">
            <!-- ABAS -->
            <div class="tabs-header">
                <button class="tab-btn active" data-tab="dashboard">
                    <i class="fas fa-tachometer-alt"></i> Dashboard
                </button>
                <button class="tab-btn" data-tab="atributos">
                    <i class="fas fa-dumbbell"></i> Atributos
                </button>
                <button class="tab-btn" data-tab="vantagens">
                    <i class="fas fa-star-half-alt"></i> Vant/Desv
                </button>
                <button class="tab-btn" data-tab="pericias">
                    <i class="fas fa-brain"></i> Per√≠cias/T√©cnicas
                </button>
                <button class="tab-btn" data-tab="magia">
                    <i class="fas fa-hat-wizard"></i> Magia
                </button>
                <button class="tab-btn" data-tab="combate">
                    <i class="fas fa-fist-raised"></i> Combate
                </button>
                <button class="tab-btn" data-tab="equipamentos">
                    <i class="fas fa-suitcase"></i> Equipamentos
                </button>
            </div>

            <!-- CONTE√öDO DAS ABAS -->
            <div class="tab-content">
                <!-- DASHBOARD -->
                <div class="tab-pane active" id="dashboard">
                    <div class="dashboard-container">
                        <!-- LINHA 1: IDENTIDADE DO PERSONAGEM -->
                        <div class="dashboard-card card-identity">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fas fa-id-card"></i>
                                    <h3>Identidade do Personagem</h3>
                                </div>
                                <span class="card-status" id="status-identidade">0%</span>
                            </div>
                            
                            <div class="card-content">
                                <!-- IMAGEM DO PERSONAGEM -->
                                <div class="imagem-personagem-container">
                                    <div class="imagem-placeholder" id="imagem-placeholder" onclick="document.getElementById('upload-imagem').click()">
                                        <i class="fas fa-user-circle"></i>
                                        <p>Clique para adicionar imagem</p>
                                    </div>
                                    <div class="imagem-preview" id="imagem-preview" style="display: none;">
                                        <img id="preview-img">
                                    </div>
                                    <div class="botoes-imagem">
                                        <button class="btn-imagem" onclick="document.getElementById('upload-imagem').click()">
                                            <i class="fas fa-upload"></i> Escolher
                                        </button>
                                        <button class="btn-imagem remover" id="btn-remover-imagem" style="display: none;">
                                            <i class="fas fa-trash"></i> Excluir
                                        </button>
                                    </div>
                                    <input type="file" id="upload-imagem" accept="image/*" style="display: none;">
                                </div>
                                
                                <!-- NOME -->
                                <div class="form-group">
                                    <label>
                                        <i class="fas fa-signature"></i> Nome do Personagem
                                    </label>
                                    <input type="text" id="nome-pc" placeholder="Ex: Aragorn, Conan, Geralt..." 
                                           class="form-input">
                                </div>
<!-- ID DO PERSONAGEM E IDADE -->
<div class="form-row">
    <div class="form-group">
        <label>
            <i class="fas fa-fingerprint"></i> ID do Personagem
        </label>
        <!-- INPUT ID - SER√Å PREENCHIDO PELO SISTEMA -->
        <input type="text" id="id-personagem" value="Aguardando salvamento..." readonly 
               class="form-input" style="color: #888; font-style: italic;">
        <small id="id-info" style="color: #666; font-size: 0.8rem; display: block; margin-top: 5px;">
            <i class="fas fa-info-circle"></i> O ID ser√° gerado automaticamente ao salvar o personagem
        </small>
    </div>
    
    <div class="form-group">
        <label>
            <i class="fas fa-birthday-cake"></i> Idade
        </label>
        <input type="number" id="idade-pc" value="25" min="12" max="150" 
               class="form-input">
    </div>
</div>>
                                
                                <!-- RA√áA E CLASSE -->
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>
                                            <i class="fas fa-dragon"></i> Ra√ßa
                                        </label>
                                        <select id="raca-pc" class="form-select">
                                            <option value="">Selecione uma ra√ßa...</option>
                                            <option value="humano">Humano</option>
                                            <option value="elfo">Elfo</option>
                                            <option value="anao">An√£o</option>
                                            <option value="orc">Orc</option>
                                            <option value="halfling">Halfling</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label>
                                            <i class="fas fa-helmet-battle"></i> Classe
                                        </label>
                                        <select id="classe-pc" class="form-select">
                                            <option value="">Selecione uma classe...</option>
                                            <option value="guerreiro">Guerreiro</option>
                                            <option value="mago">Mago</option>
                                            <option value="clerigo">Cl√©rigo</option>
                                            <option value="ladino">Ladino</option>
                                            <option value="barbaro">B√°rbaro</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <!-- N√çVEL TECNOL√ìGICO -->
                                <div class="form-group">
                                    <label>
                                        <i class="fas fa-cogs"></i> N√≠vel Tecnol√≥gico (NT)
                                    </label>
                                    <select id="nt-pc" class="form-select">
                                        <option value="">Selecione NT...</option>
                                        <option value="primitivo">Primitivo</option>
                                        <option value="medieval">Medieval</option>
                                        <option value="moderno">Moderno</option>
                                        <option value="futurista">Futurista</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="card-footer">
                                <small>Complete todos os campos para avan√ßar</small>
                            </div>
                        </div>
                        
                        <!-- LINHA 2: APAR√äNCIA F√çSICA E IDIOMAS -->
                        <div class="dashboard-grid">
                            <!-- CARD APAR√äNCIA F√çSICA -->
                            <div class="dashboard-card">
                                <div class="card-header">
                                    <div class="card-title">
                                        <i class="fas fa-user"></i>
                                        <h3>Apar√™ncia F√≠sica</h3>
                                    </div>
                                    <button class="btn-modal" onclick="abrirModalAparencia()">
                                        <i class="fas fa-sliders-h"></i> Configurar
                                    </button>
                                </div>
                                
                                <div class="card-content">
                                    <div class="appearance-summary">
                                        <div class="appearance-status">
                                            <div class="appearance-icon">
                                                <i class="fas fa-user-circle"></i>
                                            </div>
                                            <div class="appearance-info">
                                                <h4 id="aparencia-nivel">Apar√™ncia N√£o Configurada</h4>
                                                <p id="aparencia-custo">Custo: 0 pontos</p>
                                                <div class="appearance-modifiers">
                                                    <span class="modifier-badge" id="aparencia-mod-reacao">Rea√ß√£o: +0</span>
                                                    <span class="modifier-badge" id="aparencia-mod-status">Status: Normal</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- CARACTER√çSTICAS F√çSICAS RESUMO -->
                                        <div class="physical-summary">
                                            <div class="physical-item">
                                                <i class="fas fa-ruler-combined"></i>
                                                <div>
                                                    <small>Altura</small>
                                                    <strong id="altura-resumo">-</strong>
                                                </div>
                                            </div>
                                            <div class="physical-item">
                                                <i class="fas fa-weight-hanging"></i>
                                                <div>
                                                    <small>Peso</small>
                                                    <strong id="peso-resumo">-</strong>
                                                </div>
                                            </div>
                                            <div class="physical-item">
                                                <i class="fas fa-tags"></i>
                                                <div>
                                                    <small>Caracter√≠sticas</small>
                                                    <strong id="caracteristicas-resumo">-</strong>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- CARD IDIOMAS -->
                            <div class="dashboard-card">
                                <div class="card-header">
                                    <div class="card-title">
                                        <i class="fas fa-language"></i>
                                        <h3>Idiomas</h3>
                                    </div>
                                    <button class="btn-modal" onclick="abrirModalIdiomas()">
                                        <i class="fas fa-plus"></i> Gerenciar
                                    </button>
                                </div>
                                
                                <div class="card-content">
                                    <div class="language-summary">
                                        <div class="language-status">
                                            <div class="language-icon">
                                                <i class="fas fa-comments"></i>
                                            </div>
                                            <div class="language-info">
                                                <h4>Idioma Principal</h4>
                                                <p id="idioma-principal-texto">Comum</p>
                                                <div class="language-modifiers">
                                                    <span class="modifier-badge" id="total-idiomas">0 adicionais</span>
                                                    <span class="modifier-badge" id="alfabetizacao-texto">Alfabetizado</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="language-list" id="lista-idiomas-resumo">
                                            <div class="empty-state">
                                                <i class="fas fa-comment-slash"></i>
                                                <p>Nenhum idioma adicional</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- LINHA 3: RIQUEZA -->
                        <div class="dashboard-card card-wide">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fas fa-coins"></i>
                                    <h3>N√≠vel de Riqueza</h3>
                                </div>
                                <button class="btn-modal" onclick="abrirModalRiqueza()">
                                    <i class="fas fa-chart-line"></i> Selecionar N√≠vel
                                </button>
                            </div>
                            
                            <div class="card-content">
                                <div class="wealth-summary">
                                    <div class="wealth-status">
                                        <div class="wealth-icon">
                                            <i class="fas fa-gem"></i>
                                        </div>
                                        <div class="wealth-info">
                                            <h4 id="nivel-riqueza-texto">N√≠vel N√£o Selecionado</h4>
                                            <p id="renda-mensal-texto">Renda: $ 0</p>
                                            <div class="wealth-modifiers">
                                                <span class="modifier-badge" id="pontos-riqueza">0 pontos</span>
                                                <span class="modifier-badge" id="multiplicador-riqueza">Multiplicador: 0x</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="wealth-details">
                                        <div class="wealth-item">
                                            <i class="fas fa-wallet"></i>
                                            <div>
                                                <small>Dinheiro Inicial</small>
                                                <strong id="dinheiro-inicial">$ 0</strong>
                                            </div>
                                        </div>
                                        <div class="wealth-item">
                                            <i class="fas fa-home"></i>
                                            <div>
                                                <small>Recursos</small>
                                                <strong id="recursos-riqueza">-</strong>
                                            </div>
                                        </div>
                                        <div class="wealth-item">
                                            <i class="fas fa-hand-holding-usd"></i>
                                            <div>
                                                <small>Renda Mensal</small>
                                                <strong id="renda-mensal">$ 0</strong>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="card-footer">
                                    <small>Este valor ser√° usado como base para compras na aba Equipamentos</small>
                                </div>
                            </div>
                        </div>
                        
                        <!-- LINHA 4: RESUMO DE GASTOS E REA√á√ÉO -->
                        <div class="dashboard-grid">
                            <div class="dashboard-card card-summary">
                                <div class="card-header">
                                    <div class="card-title">
                                        <i class="fas fa-calculator"></i>
                                        <h3>Resumo de Gastos</h3>
                                    </div>
                                    <span class="card-badge" id="total-gasto">0/150 pts</span>
                                </div>
                                
                                <div class="card-content">
                                    <div class="expenses-grid">
                                        <div class="expense-item">
                                            <div class="expense-label">
                                                <i class="fas fa-dumbbell"></i> Atributos
                                            </div>
                                            <div class="expense-value" id="gasto-atributos">0</div>
                                            <div class="expense-progress">
                                                <div class="progress-bar" style="width: 0%"></div>
                                            </div>
                                        </div>
                                        <div class="expense-item">
                                            <div class="expense-label">
                                                <i class="fas fa-star"></i> Vantagens
                                            </div>
                                            <div class="expense-value" id="gasto-vantagens">0</div>
                                            <div class="expense-progress">
                                                <div class="progress-bar" style="width: 0%"></div>
                                            </div>
                                        </div>
                                        <div class="expense-item">
                                            <div class="expense-label">
                                                <i class="fas fa-exclamation-triangle"></i> Desvantagens
                                            </div>
                                            <div class="expense-value" id="gasto-desvantagens">0</div>
                                            <div class="expense-progress">
                                                <div class="progress-bar" style="width: 0%"></div>
                                            </div>
                                        </div>
                                        <div class="expense-item">
                                            <div class="expense-label">
                                                <i class="fas fa-brain"></i> Per√≠cias
                                            </div>
                                            <div class="expense-value" id="gasto-pericias">0</div>
                                            <div class="expense-progress">
                                                <div class="progress-bar" style="width: 0%"></div>
                                            </div>
                                        </div>
                                        <div class="expense-item">
                                            <div class="expense-label">
                                                <i class="fas fa-tools"></i> T√©cnicas
                                            </div>
                                            <div class="expense-value" id="gasto-tecnicas">0</div>
                                            <div class="expense-progress">
                                                <div class="progress-bar" style="width: 0%"></div>
                                            </div>
                                        </div>
                                        <div class="expense-item">
                                            <div class="expense-label">
                                                <i class="fas fa-user-tag"></i> Peculiaridades
                                            </div>
                                            <div class="expense-value" id="gasto-peculiaridades">0</div>
                                            <div class="expense-progress">
                                                <div class="progress-bar" style="width: 0%"></div>
                                            </div>
                                        </div>
                                        <div class="expense-item">
                                            <div class="expense-label">
                                                <i class="fas fa-hat-wizard"></i> Magias
                                            </div>
                                            <div class="expense-value" id="gasto-magias">0</div>
                                            <div class="expense-progress">
                                                <div class="progress-bar" style="width: 0%"></div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="expenses-total">
                                        <div class="total-item">
                                            <div class="total-label">Total Gasto</div>
                                            <div class="total-value" id="total-gasto-num">0 pts</div>
                                        </div>
                                        <div class="total-item">
                                            <div class="total-label">Dispon√≠vel</div>
                                            <div class="total-value available" id="pontos-disponiveis-dashboard">150 pts</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- CARD SISTEMA DE REA√á√ÉO -->
                            <div class="dashboard-card card-reaction">
                                <div class="card-header">
                                    <div class="card-title">
                                        <i class="fas fa-handshake"></i>
                                        <h3>Sistema de Rea√ß√£o</h3>
                                    </div>
                                    <span class="card-badge">Modificadores</span>
                                </div>
                                
                                <div class="card-content">
                                    <div class="reaction-list">
                                        <div class="reaction-item">
                                            <div class="reaction-label">
                                                <i class="fas fa-eye"></i> Apar√™ncia
                                            </div>
                                            <div class="reaction-value" id="mod-aparencia">+0</div>
                                        </div>
                                        <div class="reaction-item">
                                            <div class="reaction-label">
                                                <i class="fas fa-crown"></i> Reputa√ß√£o
                                            </div>
                                            <div class="reaction-value" id="mod-reputacao">+0</div>
                                        </div>
                                        <div class="reaction-item">
                                            <div class="reaction-label">
                                                <i class="fas fa-chess-queen"></i> Status
                                            </div>
                                            <div class="reaction-value" id="mod-status">+0</div>
                                        </div>
                                        <div class="reaction-item">
                                            <div class="reaction-label">
                                                <i class="fas fa-comments"></i> Carisma
                                            </div>
                                            <div class="reaction-value" id="mod-carisma">+0</div>
                                        </div>
                                        <div class="reaction-item total">
                                            <div class="reaction-label">
                                                <i class="fas fa-calculator"></i> Total de Rea√ß√£o
                                            </div>
                                            <div class="reaction-value total" id="total-reacao">+0</div>
                                        </div>
                                    </div>
                                    
                                    <div class="card-footer">
                                        <small>Modificadores aplicados a testes de rea√ß√£o social</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- MODAIS -->
                    <!-- MODAL APAR√äNCIA -->
                    <div id="modal-aparencia" class="dashboard-modal">
                        <div class="modal-content large">
                            <div class="modal-header">
                                <h3><i class="fas fa-user-edit"></i> Configurar Apar√™ncia F√≠sica</h3>
                                <button class="modal-close" onclick="fecharModal('aparencia')">&times;</button>
                            </div>
                            
                            <div class="modal-body">
                                <div class="modal-section">
                                    <h4><i class="fas fa-sliders-h"></i> N√≠vel de Apar√™ncia</h4>
                                    <div class="niveis-grid" id="niveis-aparencia"></div>
                                </div>
                                
                                <div class="modal-section">
                                    <h4><i class="fas fa-user-tag"></i> Caracter√≠sticas F√≠sicas</h4>
                                    <div class="niveis-grid" id="caracteristicas-fisicas"></div>
                                </div>
                                
                                <div class="modal-section">
                                    <h4><i class="fas fa-palette"></i> Caracter√≠sticas Visuais</h4>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>Altura (m)</label>
                                            <input type="number" id="modal-altura" min="1.20" max="2.50" step="0.01" value="1.70" class="form-input">
                                        </div>
                                        <div class="form-group">
                                            <label>Peso (kg)</label>
                                            <input type="number" id="modal-peso" min="20" max="200" step="0.5" value="70" class="form-input">
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>Cor da Pele</label>
                                            <select id="modal-cor-pele" class="form-select">
                                                <option>Muito clara</option>
                                                <option>Clara</option>
                                                <option selected>Morena</option>
                                                <option>Morena escura</option>
                                                <option>Escura</option>
                                                <option>Muito escura</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label>Cor dos Olhos</label>
                                            <select id="modal-cor-olhos" class="form-select">
                                                <option>Azuis</option>
                                                <option>Verdes</option>
                                                <option selected>Castanhos</option>
                                                <option>Castanhos escuros</option>
                                                <option>Pretos</option>
                                                <option>Vermelhos</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>Cor do Cabelo</label>
                                            <select id="modal-cor-cabelo" class="form-select">
                                                <option>Loiro</option>
                                                <option>Ruivo</option>
                                                <option selected>Castanho</option>
                                                <option>Castanho escuro</option>
                                                <option>Preto</option>
                                                <option>Grisalho</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label>Tipo de Cabelo</label>
                                            <select id="modal-tipo-cabelo" class="form-select">
                                                <option selected>Curto</option>
                                                <option>Longo</option>
                                                <option>M√©dio</option>
                                                <option>Liso</option>
                                                <option>Ondulado</option>
                                                <option>Cacheado</option>
                                                <option>Crespo</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="modal-footer">
                                <button class="btn-secondary" onclick="fecharModal('aparencia')">Cancelar</button>
                                <button class="btn-primary" onclick="salvarAparencia()">Salvar Apar√™ncia</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- MODAL IDIOMAS -->
                    <div id="modal-idiomas" class="dashboard-modal">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3><i class="fas fa-language"></i> Gerenciar Idiomas</h3>
                                <button class="modal-close" onclick="fecharModal('idiomas')">&times;</button>
                            </div>
                            
                            <div class="modal-body">
                                <div class="modal-section">
                                    <h4><i class="fas fa-book"></i> Idioma Principal</h4>
                                    <div class="form-group">
                                        <label>Nome do Idioma Materno</label>
                                        <input type="text" id="modal-idioma-materno" value="Comum" class="form-input">
                                    </div>
                                </div>
                                
                                <div class="modal-section">
                                    <h4><i class="fas fa-graduation-cap"></i> Alfabetiza√ß√£o</h4>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>
                                                <input type="radio" name="alfabetizacao" value="0" checked> Alfabetizado (0 pts)
                                            </label>
                                        </div>
                                        <div class="form-group">
                                            <label>
                                                <input type="radio" name="alfabetizacao" value="-5"> Semianalfabeto (-5 pts)
                                            </label>
                                        </div>
                                        <div class="form-group">
                                            <label>
                                                <input type="radio" name="alfabetizacao" value="-10"> Analfabeto (-10 pts)
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="modal-section">
                                    <h4><i class="fas fa-plus-circle"></i> Idiomas Adicionais</h4>
                                    <div class="form-adicionar">
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label>Nome do Idioma</label>
                                                <input type="text" id="novo-idioma-nome" placeholder="Ex: √âlfico, An√£o, Infernal..." class="form-input">
                                            </div>
                                            <div class="form-group">
                                                <label>N√≠vel de Fala</label>
                                                <select id="novo-idioma-fala" class="form-select">
                                                    <option value="0">Nenhum (0 pts)</option>
                                                    <option value="2">Rudimentar (+2 pts)</option>
                                                    <option value="4">Sotaque (+4 pts)</option>
                                                    <option value="6" selected>Nativo (+6 pts)</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label>N√≠vel de Escrita</label>
                                                <select id="novo-idioma-escrita" class="form-select">
                                                    <option value="0" selected>Nenhum (0 pts)</option>
                                                    <option value="1">Rudimentar (+1 pts)</option>
                                                    <option value="2">Sotaque (+2 pts)</option>
                                                    <option value="3">Nativo (+3 pts)</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label>Pontos Estimados: <span id="preview-custo-idioma" class="pontos-positivo">+6 pts</span></label>
                                        </div>
                                        <button class="btn-primary" onclick="adicionarIdioma()">
                                            <i class="fas fa-plus"></i> Adicionar Idioma
                                        </button>
                                    </div>
                                    
                                    <div class="lista-itens" id="lista-idiomas-modal">
                                        <p style="color: #aaa; text-align: center; padding: 20px;">Nenhum idioma adicional adicionado</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="modal-footer">
                                <button class="btn-secondary" onclick="fecharModal('idiomas')">Cancelar</button>
                                <button class="btn-primary" onclick="salvarIdiomas()">Salvar Idiomas</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- MODAL RIQUEZA -->
                    <div id="modal-riqueza" class="dashboard-modal">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3><i class="fas fa-coins"></i> Selecionar N√≠vel de Riqueza</h3>
                                <button class="modal-close" onclick="fecharModal('riqueza')">&times;</button>
                            </div>
                            
                            <div class="modal-body">
                                <div class="modal-section">
                                    <h4><i class="fas fa-chart-line"></i> N√≠veis de Riqueza</h4>
                                    <div class="niveis-grid" id="niveis-riqueza"></div>
                                </div>
                                
                                <div class="modal-section">
                                    <h4><i class="fas fa-info-circle"></i> Detalhes do N√≠vel Selecionado</h4>
                                    <div id="detalhes-riqueza" style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; border: 1px solid rgba(212,175,55,0.1);">
                                        <p style="color: #aaa; text-align: center;">Selecione um n√≠vel para ver os detalhes</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="modal-footer">
                                <button class="btn-secondary" onclick="fecharModal('riqueza')">Cancelar</button>
                                <button class="btn-primary" onclick="salvarRiqueza()">Selecionar N√≠vel</button>
                            </div>
                        </div>
                    </div>
                </div>

               <!-- ATRIBUTOS -->
<div class="tab-pane" id="atributos">
    <div class="atributos-container">
        <!-- HEADER COM PONTOS -->
        <div class="atributos-header">
            <h2><i class="fas fa-dumbbell"></i> Atributos do Personagem</h2>
            <div class="card-pontos">
                <div class="ponto-total">
                    <div class="ponto-label">Pontos Gastos em Atributos</div>
                    <div id="pontosGastos" class="ponto-valor">0</div>
                </div>
            </div>
        </div>

        <!-- 4 ATRIBUTOS PRINCIPAIS -->
        <div class="atributos-principais">
            <!-- ST - FOR√áA -->
            <div class="atributo-card">
                <div class="atributo-titulo">
                    <i class="fas fa-fist-raised"></i>
                    <div class="atributo-info">
                        <div class="atributo-sigla">ST</div>
                        <div class="atributo-nome">FOR√áA</div>
                    </div>
                </div>
                
                <div class="atributo-valor">
                    <button class="btn-atributo menos" onclick="alterarAtributo('ST', -1)">
                        <i class="fas fa-minus"></i>
                    </button>
                    <input type="number" id="ST" class="input-atributo" value="10" min="1" max="40">
                    <button class="btn-atributo mais" onclick="alterarAtributo('ST', 1)">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
                
                <div class="atributo-custo">
                    <span>Custo:</span>
                    <span id="custoST" class="custo-valor">0</span>
                </div>
            </div>

            <!-- DX - DESTREZA -->
            <div class="atributo-card">
                <div class="atributo-titulo">
                    <i class="fas fa-running"></i>
                    <div class="atributo-info">
                        <div class="atributo-sigla">DX</div>
                        <div class="atributo-nome">DESTREZA</div>
                    </div>
                </div>
                
                <div class="atributo-valor">
                    <button class="btn-atributo menos" onclick="alterarAtributo('DX', -1)">
                        <i class="fas fa-minus"></i>
                    </button>
                    <input type="number" id="DX" class="input-atributo" value="10" min="1" max="40">
                    <button class="btn-atributo mais" onclick="alterarAtributo('DX', 1)">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
                
                <div class="atributo-custo">
                    <span>Custo:</span>
                    <span id="custoDX" class="custo-valor">0</span>
                </div>
            </div>

            <!-- IQ - INTELIG√äNCIA -->
            <div class="atributo-card">
                <div class="atributo-titulo">
                    <i class="fas fa-brain"></i>
                    <div class="atributo-info">
                        <div class="atributo-sigla">IQ</div>
                        <div class="atributo-nome">INTELIG√äNCIA</div>
                    </div>
                </div>
                
                <div class="atributo-valor">
                    <button class="btn-atributo menos" onclick="alterarAtributo('IQ', -1)">
                        <i class="fas fa-minus"></i>
                    </button>
                    <input type="number" id="IQ" class="input-atributo" value="10" min="1" max="40">
                    <button class="btn-atributo mais" onclick="alterarAtributo('IQ', 1)">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
                
                <div class="atributo-custo">
                    <span>Custo:</span>
                    <span id="custoIQ" class="custo-valor">0</span>
                </div>
            </div>

            <!-- HT - SA√öDE -->
            <div class="atributo-card">
                <div class="atributo-titulo">
                    <i class="fas fa-heart"></i>
                    <div class="atributo-info">
                        <div class="atributo-sigla">HT</div>
                        <div class="atributo-nome">SA√öDE</div>
                    </div>
                </div>
                
                <div class="atributo-valor">
                    <button class="btn-atributo menos" onclick="alterarAtributo('HT', -1)">
                        <i class="fas fa-minus"></i>
                    </button>
                    <input type="number" id="HT" class="input-atributo" value="10" min="1" max="40">
                    <button class="btn-atributo mais" onclick="alterarAtributo('HT', 1)">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
                
                <div class="atributo-custo">
                    <span>Custo:</span>
                    <span id="custoHT" class="custo-valor">0</span>
                </div>
            </div>
        </div>

        <!-- ATRIBUTOS SECUND√ÅRIOS -->
        <div class="secao-titulo">
            <h3><i class="fas fa-calculator"></i> Atributos Secund√°rios</h3>
        </div>
        
        <div class="atributos-secundarios">
            <!-- PV - Pontos de Vida -->
            <div class="secundario-card">
                <div class="secundario-header">
                    <i class="fas fa-heartbeat"></i>
                    <div class="secundario-info">
                        <div class="secundario-sigla">PV</div>
                        <div class="secundario-nome">Pontos de Vida</div>
                    </div>
                </div>
                <div class="secundario-base">Base: <span id="PVBase">10</span></div>
                
                <div class="secundario-ajuste">
                    <button class="btn-secundario menos" onclick="ajustarSecundario('PV', -1)">
                        <i class="fas fa-minus"></i>
                    </button>
                    <input type="number" id="bonusPV" class="secundario-bonus" value="0" placeholder="B√¥nus">
                    <button class="btn-secundario mais" onclick="ajustarSecundario('PV', 1)">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
                
                <div class="secundario-total">Total: <span id="PVTotal">10</span></div>
            </div>

            <!-- PF - Pontos de Fadiga -->
            <div class="secundario-card">
                <div class="secundario-header">
                    <i class="fas fa-wind"></i>
                    <div class="secundario-info">
                        <div class="secundario-sigla">PF</div>
                        <div class="secundario-nome">Pontos de Fadiga</div>
                    </div>
                </div>
                <div class="secundario-base">Base: <span id="PFBase">10</span></div>
                
                <div class="secundario-ajuste">
                    <button class="btn-secundario menos" onclick="ajustarSecundario('PF', -1)">
                        <i class="fas fa-minus"></i>
                    </button>
                    <input type="number" id="bonusPF" class="secundario-bonus" value="0" placeholder="B√¥nus">
                    <button class="btn-secundario mais" onclick="ajustarSecundario('PF', 1)">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
                
                <div class="secundario-total">Total: <span id="PFTotal">10</span></div>
            </div>

            <!-- VONTADE -->
            <div class="secundario-card">
                <div class="secundario-header">
                    <i class="fas fa-cross"></i>
                    <div class="secundario-info">
                        <div class="secundario-sigla">VON</div>
                        <div class="secundario-nome">Vontade</div>
                    </div>
                </div>
                <div class="secundario-base">Base: <span id="VontadeBase">10</span></div>
                
                <div class="secundario-ajuste">
                    <button class="btn-secundario menos" onclick="ajustarSecundario('Vontade', -1)">
                        <i class="fas fa-minus"></i>
                    </button>
                    <input type="number" id="bonusVontade" class="secundario-bonus" value="0" placeholder="B√¥nus">
                    <button class="btn-secundario mais" onclick="ajustarSecundario('Vontade', 1)">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
                
                <div class="secundario-total">Total: <span id="VontadeTotal">10</span></div>
            </div>

            <!-- PERCEP√á√ÉO -->
            <div class="secundario-card">
                <div class="secundario-header">
                    <i class="fas fa-eye"></i>
                    <div class="secundario-info">
                        <div class="secundario-sigla">PER</div>
                        <div class="secundario-nome">Percep√ß√£o</div>
                    </div>
                </div>
                <div class="secundario-base">Base: <span id="PercepcaoBase">10</span></div>
                
                <div class="secundario-ajuste">
                    <button class="btn-secundario menos" onclick="ajustarSecundario('Percepcao', -1)">
                        <i class="fas fa-minus"></i>
                    </button>
                    <input type="number" id="bonusPercepcao" class="secundario-bonus" value="0" placeholder="B√¥nus">
                    <button class="btn-secundario mais" onclick="ajustarSecundario('Percepcao', 1)">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
                
                <div class="secundario-total">Total: <span id="PercepcaoTotal">10</span></div>
            </div>

            <!-- DESLOCAMENTO -->
            <div class="secundario-card">
                <div class="secundario-header">
                    <i class="fas fa-shoe-prints"></i>
                    <div class="secundario-info">
                        <div class="secundario-sigla">DES</div>
                        <div class="secundario-nome">Deslocamento</div>
                    </div>
                </div>
                <div class="secundario-base">Base: <span id="DeslocamentoBase">5.00</span></div>
                
                <div class="secundario-ajuste">
                    <button class="btn-secundario menos" onclick="ajustarSecundario('Deslocamento', -0.25)">
                        <i class="fas fa-minus"></i>
                    </button>
                    <input type="number" id="bonusDeslocamento" class="secundario-bonus" value="0" step="0.25" placeholder="B√¥nus">
                    <button class="btn-secundario mais" onclick="ajustarSecundario('Deslocamento', 0.25)">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
                
                <div class="secundario-total">Total: <span id="DeslocamentoTotal">5.00</span></div>
            </div>
        </div>

        <!-- T√ÅBUAS DE REFER√äNCIA -->
        <div class="secao-titulo">
            <h3><i class="fas fa-table"></i> Tabelas de Refer√™ncia</h3>
        </div>
        
        <div class="tabelas-container">
            <div class="tabela-card">
                <div class="tabela-titulo">
                    <i class="fas fa-sword"></i>
                    <span>Dano Base (ST: <span id="currentST">10</span>)</span>
                </div>
                <div class="tabela-conteudo">
                    <div class="tabela-item">
                        <span class="tabela-label">Golpe Desarmado (GDP):</span>
                        <span id="danoGDP" class="tabela-valor">1d-2</span>
                    </div>
                    <div class="tabela-item">
                        <span class="tabela-label">Golpe com Arma (GEB):</span>
                        <span id="danoGEB" class="tabela-valor">1d</span>
                    </div>
                </div>
            </div>

            <div class="tabela-card">
                <div class="tabela-titulo">
                    <i class="fas fa-weight-hanging"></i>
                    <span>Capacidade de Carga (ST: <span id="currentST2">10</span>)</span>
                </div>
                <div class="tabela-conteudo">
                    <div class="tabela-item">
                        <span class="tabela-label">Nenhuma:</span>
                        <span id="cargaNenhuma" class="tabela-valor">10.0</span>
                    </div>
                    <div class="tabela-item">
                        <span class="tabela-label">Leve:</span>
                        <span id="cargaLeve" class="tabela-valor">20.0</span>
                    </div>
                    <div class="tabela-item">
                        <span class="tabela-label">M√©dia:</span>
                        <span id="cargaMedia" class="tabela-valor">30.0</span>
                    </div>
                    <div class="tabela-item">
                        <span class="tabela-label">Pesada:</span>
                        <span id="cargaPesada" class="tabela-valor">60.0</span>
                    </div>
                    <div class="tabela-item">
                        <span class="tabela-label">Muito Pesada:</span>
                        <span id="cargaMuitoPesada" class="tabela-valor">100.0</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- MENSAGEM DE STATUS -->
        <div id="statusAtributos" class="status-mensagem">
            <i class="fas fa-info-circle"></i>
            <span>Sistema de atributos inicializado. Ajuste os valores conforme necess√°rio.</span>
        </div>
    </div>
</div>

                <!-- VANTAGENS/DESVANTAGENS -->
                <div class="tab-pane" id="vantagens">
                    <div style="text-align: center; padding: 100px 20px;">
                        <i class="fas fa-star-half-alt" style="font-size: 4rem; color: #FF9800; margin-bottom: 20px;"></i>
                        <h2 style="color: #FF9800; margin-bottom: 20px;">Vantagens/Desvantagens</h2>
                        <p style="color: #aaa;">Sistema de vantagens e desvantagens em desenvolvimento</p>
                    </div>
                </div>

                <!-- PER√çCIAS/T√âCNICAS -->
                <div class="tab-pane" id="pericias">
                    <div style="text-align: center; padding: 100px 20px;">
                        <i class="fas fa-brain" style="font-size: 4rem; color: #9C27B0; margin-bottom: 20px;"></i>
                        <h2 style="color: #9C27B0; margin-bottom: 20px;">Per√≠cias/T√©cnicas</h2>
                        <p style="color: #aaa;">Sistema de per√≠cias e t√©cnicas em desenvolvimento</p>
                    </div>
                </div>

                <!-- MAGIA -->
                <div class="tab-pane" id="magia">
                    <div style="text-align: center; padding: 100px 20px;">
                        <i class="fas fa-hat-wizard" style="font-size: 4rem; color: #2196F3; margin-bottom: 20px;"></i>
                        <h2 style="color: #2196F3; margin-bottom: 20px;">Magia</h2>
                        <p style="color: #aaa;">Sistema de magia em desenvolvimento</p>
                    </div>
                </div>

                <!-- COMBATE -->
                <div class="tab-pane" id="combate">
                    <div style="text-align: center; padding: 100px 20px;">
                        <i class="fas fa-fist-raised" style="font-size: 4rem; color: #f44336; margin-bottom: 20px;"></i>
                        <h2 style="color: #f44336; margin-bottom: 20px;">Combate</h2>
                        <p style="color: #aaa;">Sistema de combate em desenvolvimento</p>
                    </div>
                </div>

                <!-- EQUIPAMENTOS -->
                <div class="tab-pane" id="equipamentos">
                    <div style="text-align: center; padding: 100px 20px;">
                        <i class="fas fa-suitcase" style="font-size: 4rem; color: #795548; margin-bottom: 20px;"></i>
                        <h2 style="color: #795548; margin-bottom: 20px;">Equipamentos</h2>
                        <p style="color: #aaa;">Sistema de equipamentos em desenvolvimento</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- RODAP√â -->
    <footer class="main-footer">
        <p>Sistema de Cria√ß√£o de Personagem Role 3d6 | Salve seu progresso regularmente</p>
    </footer>
    <script src="atributos.js"></script>
    <script src="firebase-save.js"></script>
    <script>
   // ===== SISTEMA DE PONTOS GLOBAL =====
class SistemaPontos {
    constructor() {
        this.categorias = {
            atributos: 0,
            vantagens: 0,
            desvantagens: 0,
            pericias: 0,
            peculiaridades: 0,
            magias: 0
        };
        
        this.totalPontos = 150;
        this.gastoTotal = 0;
        
        this.limites = {
            desvantagens: -112,
            peculiaridades: 100
        };
        
        this.inicializar();
    }
    
    inicializar() {
        this.atualizarTotal();
        this.atualizarLimitesDisplay();
    }
    
    atualizarLimitesDisplay() {
        const limitesInfo = document.getElementById('limites-info');
        const limiteDesvantagens = document.getElementById('limite-desvantagens');
        
        if (limitesInfo) {
            limitesInfo.textContent = `Desv ‚â§ ${this.limites.desvantagens} | Pec ‚â§ ${this.limites.peculiaridades}`;
        }
        if (limiteDesvantagens) {
            limiteDesvantagens.textContent = this.limites.desvantagens;
        }
    }
    
    atualizarCategoria(categoria, pontos) {
        // Para desvantagens (valores negativos)
        if (categoria === 'desvantagens') {
            if (pontos < this.limites.desvantagens) {
                this.mostrarNotificacao(`Limite de desvantagens excedido! M√°ximo permitido: ${this.limites.desvantagens} pontos.`, 'warning');
                return false;
            }
        }
        
        // Para peculiaridades (valores positivos)
        if (categoria === 'peculiaridades') {
            if (pontos > this.limites.peculiaridades) {
                this.mostrarNotificacao(`Limite de peculiaridades excedido! M√°ximo permitido: ${this.limites.peculiaridades} pontos.`, 'warning');
                return false;
            }
        }
        
        this.categorias[categoria] = pontos;
        this.atualizarTotal();
        return true;
    }
    
    atualizarTotal() {
        this.gastoTotal = Object.values(this.categorias).reduce((a, b) => a + b, 0);
        
        const pontosRestantes = this.totalPontos - this.gastoTotal;
        
        // Atualizar dashboard
        const totalGastoNum = document.getElementById('total-gasto-num');
        const pontosDisponiveisDashboard = document.getElementById('pontos-disponiveis-dashboard');
        const totalGasto = document.getElementById('total-gasto');
        
        if (totalGastoNum) totalGastoNum.textContent = `${this.gastoTotal} pts`;
        if (pontosDisponiveisDashboard) pontosDisponiveisDashboard.textContent = `${pontosRestantes} pts`;
        if (totalGasto) totalGasto.textContent = `${this.gastoTotal}/${this.totalPontos} pts`;
        
        // Atualizar cabe√ßalho
        const pontosDisponiveis = document.getElementById('pontos-disponiveis');
        if (pontosDisponiveis) pontosDisponiveis.textContent = this.totalPontos;
        
        const disponivelElement = document.getElementById('pontos-disponiveis-dashboard');
        const totalElement = document.getElementById('total-gasto');
        
        if (disponivelElement) {
            if (pontosRestantes < 0) {
                disponivelElement.style.color = '#e74c3c';
            } else if (pontosRestantes < 30) {
                disponivelElement.style.color = '#FFC107';
            } else {
                disponivelElement.style.color = '#4CAF50';
            }
        }
        
        if (totalElement) {
            if (pontosRestantes < 0) {
                totalElement.style.color = '#e74c3c';
            } else {
                totalElement.style.color = '#2196F3';
            }
        }
        
        this.atualizarBarrasProgresso();
    }
    
    atualizarBarrasProgresso() {
        const categorias = {
            'atributos': 'gasto-atributos',
            'vantagens': 'gasto-vantagens',
            'desvantagens': 'gasto-desvantagens',
            'pericias': 'gasto-pericias',
            'peculiaridades': 'gasto-peculiaridades',
            'magias': 'gasto-magias'
        };
        
        Object.entries(categorias).forEach(([cat, elementId]) => {
            const pontos = this.categorias[cat];
            const elemento = document.getElementById(elementId);
            const barra = elemento?.nextElementSibling?.querySelector('.progress-bar');
            
            if (elemento) {
                elemento.textContent = pontos;
                
                if (pontos > 0) {
                    elemento.classList.add('pontos-positivo');
                    elemento.classList.remove('pontos-negativo');
                } else if (pontos < 0) {
                    elemento.classList.add('pontos-negativo');
                    elemento.classList.remove('pontos-positivo');
                } else {
                    elemento.classList.remove('pontos-positivo', 'pontos-negativo');
                }
            }
            
            if (barra) {
                const valorAbsoluto = Math.abs(pontos);
                const max = cat === 'desvantagens' ? Math.abs(this.limites.desvantagens) : 100;
                const porcentagem = Math.min(100, (valorAbsoluto / max) * 100);
                barra.style.width = `${porcentagem}%`;
            }
        });
    }
    
    setTotalPontos(pontos) {
        this.totalPontos = pontos;
        this.atualizarLimitesDisplay();
        this.atualizarTotal();
    }
    
    setLimite(categoria, valor) {
        if (categoria === 'desvantagens' || categoria === 'peculiaridades') {
            this.limites[categoria] = categoria === 'desvantagens' ? -Math.abs(valor) : Math.abs(valor);
            this.atualizarLimitesDisplay();
            return true;
        }
        return false;
    }
    
    getPontosRestantes() {
        return this.totalPontos - this.gastoTotal;
    }
    
    getResumo() {
        return {
            totalPontos: this.totalPontos,
            gastoTotal: this.gastoTotal,
            pontosRestantes: this.getPontosRestantes(),
            limites: { ...this.limites },
            categorias: { ...this.categorias }
        };
    }
    
    mostrarNotificacao(mensagem, tipo = 'info') {
        // Criar elemento de notifica√ß√£o
        const notificacao = document.createElement('div');
        notificacao.className = 'notificacao-flutuante';
        notificacao.innerHTML = `
            <i class="fas ${tipo === 'success' ? 'fa-check-circle' : tipo === 'warning' ? 'fa-exclamation-triangle' : 'fa-info-circle'}"></i>
            <span>${mensagem}</span>
        `;
        
        document.body.appendChild(notificacao);
        
        // Remover ap√≥s 5 segundos
        setTimeout(() => {
            notificacao.remove();
        }, 5000);
    }
}

// ===== INST√ÇNCIA GLOBAL =====
const sistemaPontos = new SistemaPontos();

// ===== FIREBASE =====
const firebaseConfig = {
    apiKey: "AIzaSyBlA5LPfHt7LXZfj_BwMbV2hRnk7bAUChk",
    authDomain: "role3d6-cae77.firebaseapp.com",
    projectId: "role3d6-cae77",
    storageBucket: "role3d6-cae77.firebasestorage.app",
    messagingSenderId: "37912599534",
    appId: "1:37912599534:web:5c89d8d8ffac228f594cff"
};

let auth, db;

// ===== VARI√ÅVEIS GLOBAIS =====
let personagem = {
    pontosDisponiveis: 150,
    dinheiro: 1000,
    dados: {},
    criadoEm: null,
    atualizadoEm: null
};

// ===== FUN√á√ÉO SALVAR PERSONAGEM ATUALIZADA =====
async function salvarPersonagem() {
    try {
        if (!auth || !auth.currentUser) {
            alert('‚ö†Ô∏è Fa√ßa login para salvar o personagem!');
            return;
        }

        const btnSalvar = document.getElementById('btnSalvar');
        const originalHTML = btnSalvar.innerHTML;
        
        btnSalvar.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Salvando...';
        btnSalvar.disabled = true;

        // Coletar dados das 3 partes
        const dadosPersonagem = {
            // 1. Dados da Dashboard
            dashboard: {
                nome: document.getElementById('nome-pc')?.value || 'Personagem sem nome',
                idade: parseInt(document.getElementById('idade-pc')?.value) || 25,
                raca: document.getElementById('raca-pc')?.value || '',
                classe: document.getElementById('classe-pc')?.value || '',
                nivelTecnologico: document.getElementById('nt-pc')?.value || '',
                imagem: localStorage.getItem('personagem_imagem') || '',
                
                // Pontos
                pontosTotais: sistemaPontos.totalPontos,
                pontosGastos: sistemaPontos.gastoTotal,
                pontosDisponiveis: sistemaPontos.getPontosRestantes(),
                
                // Dinheiro
                dinheiro: personagem.dinheiro || 1000,
                
                // Sistemas
                aparencia: window.dadosAparencia || {},
                idiomas: window.dadosIdiomas || {},
                riqueza: window.dadosRiqueza || {},
                
                // Status
                statusIdentidade: calcularStatusIdentidade(),
                sistemaReacao: coletarReacaoDashboard(),
                
                atualizadoEm: new Date().toISOString()
            },
            
            // 2. Dados dos Atributos
            atributos: window.obterDadosAtributos ? window.obterDadosAtributos() : {
                ST: 10,
                DX: 10,
                IQ: 10,
                HT: 10,
                bonus: {
                    PV: 0,
                    PF: 0,
                    Vontade: 0,
                    Percepcao: 0,
                    Deslocamento: 0
                },
                pontosGastos: 0,
                mensagem: "Sistema de atributos n√£o carregado"
            },
            
            // 3. Metadados
            metadata: {
                uid: auth.currentUser.uid,
                email: auth.currentUser.email,
                dataCriacao: new Date().toISOString(),
                dataAtualizacao: new Date().toISOString(),
                criadoEm: new Date().toLocaleString('pt-BR'),
                versao: '1.0',
                ativo: true
            }
        };

        // Gerar ID √∫nico
        const timestamp = Date.now().toString(36);
        const random = Math.random().toString(36).substr(2, 6);
        const idAmigavel = `PC-${timestamp}-${random}`.toUpperCase();

        // Salvar no Firebase
        const { doc, setDoc, updateDoc, getDoc } = await import("https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js");
        
        const personagemRef = doc(db, "personagens", idAmigavel);
        
        // Verificar se j√° existe
        const docSnapshot = await getDoc(personagemRef);
        
        if (docSnapshot.exists()) {
            // Atualizar existente
            await updateDoc(personagemRef, {
                ...dadosPersonagem,
                metadata: {
                    ...dadosPersonagem.metadata,
                    dataAtualizacao: new Date().toISOString(),
                    atualizadoEm: new Date().toLocaleString('pt-BR')
                }
            });
            console.log('‚úÖ Personagem atualizado:', idAmigavel);
        } else {
            // Criar novo
            await setDoc(personagemRef, dadosPersonagem);
            console.log('‚úÖ Novo personagem criado:', idAmigavel);
        }
        
        // Atualizar perfil do usu√°rio
        await atualizarPerfilUsuario(idAmigavel, dadosPersonagem.dashboard.nome);
        
        // Atualizar interface
        atualizarInterfacePosSalvamento(idAmigavel);
        
        // Salvar localmente
        salvarLocalmente(idAmigavel, dadosPersonagem);
        
        // Mensagem de sucesso
        btnSalvar.innerHTML = '<i class="fas fa-check"></i> Salvo!';
        setTimeout(() => {
            btnSalvar.innerHTML = originalHTML;
            btnSalvar.disabled = false;
        }, 2000);
        
        mostrarNotificacao(`‚úÖ Personagem salvo com sucesso! ID: ${idAmigavel}`, 'success');
        
    } catch (error) {
        console.error('‚ùå Erro ao salvar:', error);
        mostrarNotificacao(`‚ùå Erro ao salvar: ${error.message}`, 'error');
        
        const btnSalvar = document.getElementById('btnSalvar');
        btnSalvar.innerHTML = '<i class="fas fa-save"></i> Salvar';
        btnSalvar.disabled = false;
    }
}

// ===== FUN√á√ïES AUXILIARES DO SALVAMENTO =====
async function atualizarPerfilUsuario(personagemId, nomePersonagem) {
    try {
        const { doc, getDoc, updateDoc, arrayUnion, setDoc } = await import("https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js");
        
        const usuarioRef = doc(db, "usuarios", auth.currentUser.uid);
        const usuarioDoc = await getDoc(usuarioRef);
        
        const dadosPersonagemResumo = {
            id: personagemId,
            nome: nomePersonagem,
            classe: document.getElementById('classe-pc')?.value || '',
            raca: document.getElementById('raca-pc')?.value || '',
            nivel: "1",
            pontosGastos: sistemaPontos.gastoTotal,
            dataAtualizacao: new Date().toISOString()
        };
        
        if (usuarioDoc.exists()) {
            // Atualizar lista de personagens
            const personagensAtuais = usuarioDoc.data().personagens || [];
            const index = personagensAtuais.findIndex(p => p.id === personagemId);
            
            if (index !== -1) {
                // Substituir personagem existente
                personagensAtuais[index] = dadosPersonagemResumo;
                await updateDoc(usuarioRef, {
                    personagens: personagensAtuais,
                    atualizadoEm: new Date().toISOString()
                });
            } else {
                // Adicionar novo personagem
                await updateDoc(usuarioRef, {
                    personagens: arrayUnion(dadosPersonagemResumo),
                    atualizadoEm: new Date().toISOString()
                });
            }
        } else {
            // Criar perfil do usu√°rio
            await setDoc(usuarioRef, {
                uid: auth.currentUser.uid,
                email: auth.currentUser.email,
                personagens: [dadosPersonagemResumo],
                criadoEm: new Date().toISOString(),
                atualizadoEm: new Date().toISOString()
            });
        }
        
        console.log('‚úÖ Perfil do usu√°rio atualizado');
    } catch (error) {
        console.error('‚ö†Ô∏è Erro ao salvar no perfil:', error);
    }
}

function atualizarInterfacePosSalvamento(personagemId) {
    // Atualizar ID na tela
    const inputId = document.getElementById('id-personagem');
    if (inputId) {
        inputId.value = personagemId;
        inputId.style.color = '#4CAF50';
        inputId.style.fontStyle = 'normal';
        inputId.style.fontWeight = '600';
        
        const small = inputId.parentElement.querySelector('small');
        if (small) {
            small.innerHTML = `<i class="fas fa-check-circle" style="color: #4CAF50"></i> ID: ${personagemId} - Salvo em ${new Date().toLocaleTimeString('pt-BR')}`;
            small.style.color = '#4CAF50';
        }
    }
}

function salvarLocalmente(personagemId, dadosPersonagem) {
    // Salvar para edi√ß√£o futura
    localStorage.setItem('personagem_em_edicao', personagemId);
    localStorage.setItem('personagem_atual_dados', JSON.stringify(dadosPersonagem));
    
    // Salvar partes separadamente
    localStorage.setItem('personagem_dashboard', JSON.stringify(dadosPersonagem.dashboard));
    
    // Salvar atributos se existirem
    if (dadosPersonagem.atributos) {
        localStorage.setItem('personagem_atributos', JSON.stringify(dadosPersonagem.atributos));
    }
    
    console.log('‚úÖ Dados salvos localmente');
}

// ===== FUN√á√ïES DE DASHBOARD =====
function calcularStatusIdentidade() {
    const campos = ['nome-pc', 'raca-pc', 'classe-pc', 'nt-pc'];
    let completos = 0;
    
    campos.forEach(id => {
        const element = document.getElementById(id);
        if (element && element.value.trim() !== '') completos++;
    });
    
    return Math.round((completos / campos.length) * 100);
}

function coletarReacaoDashboard() {
    return {
        aparencia: document.getElementById('mod-aparencia')?.textContent || '+0',
        reputacao: document.getElementById('mod-reputacao')?.textContent || '+0',
        status: document.getElementById('mod-status')?.textContent || '+0',
        carisma: document.getElementById('mod-carisma')?.textContent || '+0',
        total: document.getElementById('total-reacao')?.textContent || '+0'
    };
}

function atualizarStatusIdentidade() {
    const statusElement = document.getElementById('status-identidade');
    if (!statusElement) return;
    
    const porcentagem = calcularStatusIdentidade();
    statusElement.textContent = `${porcentagem}%`;
    statusElement.style.background = porcentagem === 100 ? 
        'rgba(76, 175, 80, 0.15)' : 'rgba(255, 193, 7, 0.15)';
    statusElement.style.color = porcentagem === 100 ? '#4CAF50' : '#FFC107';
}

// ===== INICIALIZA√á√ÉO =====
document.addEventListener('DOMContentLoaded', async function() {
    console.log('üöÄ Inicializando sistema...');
    
    try {
        // Inicializar Firebase
        const { initializeApp } = await import("https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js");
        const { getAuth } = await import("https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js");
        const { getFirestore } = await import("https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js");
        
        const app = initializeApp(firebaseConfig);
        auth = getAuth(app);
        db = getFirestore(app);

        // Verificar autentica√ß√£o
        const { onAuthStateChanged } = await import("https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js");
        
        onAuthStateChanged(auth, (user) => {
            if (user) {
                console.log('‚úÖ Usu√°rio autenticado:', user.email);
                
                // Verificar se h√° personagem em edi√ß√£o
                const personagemId = localStorage.getItem('personagem_em_edicao');
                if (personagemId) {
                    carregarPersonagemParaEdicao(user.uid, personagemId);
                }
                
                // Carregar dados do localStorage
                carregarDadosLocais();
                
            } else {
                console.log('‚ö†Ô∏è Usu√°rio n√£o autenticado');
                window.location.href = 'login.html';
            }
        });

        // Sistema de abas
        const tabButtons = document.querySelectorAll('.tab-btn');
        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                const tabId = button.getAttribute('data-tab');
                
                tabButtons.forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll('.tab-pane').forEach(pane => {
                    pane.classList.remove('active');
                });
                
                button.classList.add('active');
                document.getElementById(tabId).classList.add('active');
                
                // Inicializar aba espec√≠fica
                if (tabId === 'atributos' && typeof initAtributosTab === 'function') {
                    initAtributosTab();
                }
            });
        });

        // Configurar eventos
        configurarEventos();
        
    } catch (error) {
        console.error('‚ùå Erro na inicializa√ß√£o:', error);
        mostrarNotificacao('Erro na inicializa√ß√£o. Verifique sua conex√£o.', 'error');
    }
});

// ===== FUN√á√ïES DE EVENTOS =====
function configurarEventos() {
    // Bot√£o Salvar
    const btnSalvar = document.getElementById('btnSalvar');
    if (btnSalvar) {
        btnSalvar.addEventListener('click', salvarPersonagem);
    }
    
    // Bot√£o Editar
    const btnEditar = document.getElementById('btnEditar');
    if (btnEditar) {
        btnEditar.addEventListener('click', () => {
            alert('Modo edi√ß√£o ativado!');
            // TODO: Implementar modo edi√ß√£o
        });
    }
    
    // Bot√£o Limpar
    const btnLimpar = document.getElementById('btnLimpar');
    if (btnLimpar) {
        btnLimpar.addEventListener('click', () => {
            if (confirm('Tem certeza que deseja limpar todos os dados do personagem?')) {
                limparTodosDados();
            }
        });
    }
    
    // Upload de imagem
    const uploadImagem = document.getElementById('upload-imagem');
    if (uploadImagem) {
        uploadImagem.addEventListener('change', function(e) {
            carregarImagem(e.target.files[0]);
        });
    }
    
    // Bot√£o remover imagem
    const btnRemoverImagem = document.getElementById('btn-remover-imagem');
    if (btnRemoverImagem) {
        btnRemoverImagem.addEventListener('click', removerImagem);
    }
    
    // Campos edit√°veis do cabe√ßalho
    const pontosDisponiveis = document.getElementById('pontos-disponiveis');
    if (pontosDisponiveis) {
        pontosDisponiveis.addEventListener('click', () => editarValor('pontos'));
    }
    
    const limiteDesvantagens = document.getElementById('limite-desvantagens');
    if (limiteDesvantagens) {
        limiteDesvantagens.addEventListener('click', () => editarValor('desvantagens'));
    }
    
    const dinheiroPc = document.getElementById('dinheiro-pc');
    if (dinheiroPc) {
        dinheiroPc.addEventListener('click', () => editarValor('dinheiro'));
    }
    
    // Inputs da identidade
    const inputsIdentidade = ['nome-pc', 'idade-pc', 'raca-pc', 'classe-pc', 'nt-pc'];
    inputsIdentidade.forEach(id => {
        const element = document.getElementById(id);
        if (element) {
            element.addEventListener('input', () => {
                atualizarStatusIdentidade();
                salvarDadosLocal();
            });
        }
    });
    
    // Preview de custo de idiomas
    const selectFala = document.getElementById('novo-idioma-fala');
    const selectEscrita = document.getElementById('novo-idioma-escrita');
    if (selectFala && selectEscrita) {
        selectFala.addEventListener('change', atualizarPreviewIdioma);
        selectEscrita.addEventListener('change', atualizarPreviewIdioma);
    }
}

// ===== FUN√á√ïES DE CARREGAMENTO =====
async function carregarPersonagemParaEdicao(userId, personagemId) {
    try {
        const { doc, getDoc } = await import("https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js");
        
        const personagemRef = doc(db, "personagens", personagemId);
        const docSnapshot = await getDoc(personagemRef);
        
        if (docSnapshot.exists()) {
            const dados = docSnapshot.data();
            preencherDadosPersonagem(dados);
            console.log('‚úÖ Personagem carregado para edi√ß√£o:', personagemId);
        }
    } catch (error) {
        console.error('‚ùå Erro ao carregar personagem:', error);
    }
}

function preencherDadosPersonagem(dados) {
    // Preencher dashboard
    if (dados.dashboard) {
        document.getElementById('nome-pc').value = dados.dashboard.nome || '';
        document.getElementById('idade-pc').value = dados.dashboard.idade || 25;
        document.getElementById('raca-pc').value = dados.dashboard.raca || '';
        document.getElementById('classe-pc').value = dados.dashboard.classe || '';
        document.getElementById('nt-pc').value = dados.dashboard.nivelTecnologico || '';
        
        // Atualizar sistema de pontos
        if (dados.dashboard.pontosTotais) {
            sistemaPontos.setTotalPontos(dados.dashboard.pontosTotais);
        }
        
        if (dados.dashboard.dinheiro) {
            personagem.dinheiro = dados.dashboard.dinheiro;
        }
        
        // Carregar sistemas da dashboard
        if (dados.dashboard.aparencia) {
            window.dadosAparencia = dados.dashboard.aparencia;
            atualizarResumoAparencia();
        }
        if (dados.dashboard.idiomas) {
            window.dadosIdiomas = dados.dashboard.idiomas;
            atualizarResumoIdiomas();
        }
        if (dados.dashboard.riqueza) {
            window.dadosRiqueza = dados.dashboard.riqueza;
            atualizarResumoRiqueza();
        }
    }
    
    // Preencher atributos
    if (dados.atributos && window.carregarDadosAtributos) {
        window.carregarDadosAtributos(dados.atributos);
    }
    
    // Preencher ID
    const personagemId = dados.metadata?.id || localStorage.getItem('personagem_em_edicao');
    if (personagemId) {
        document.getElementById('id-personagem').value = personagemId;
        document.getElementById('id-personagem').style.color = '#4CAF50';
        document.getElementById('id-personagem').style.fontStyle = 'normal';
        document.getElementById('id-personagem').style.fontWeight = '600';
    }
    
    atualizarStatusIdentidade();
    atualizarDisplay();
}

function carregarDadosLocais() {
    // Carregar dados do localStorage
    const dadosDashboard = localStorage.getItem('personagem_dashboard');
    if (dadosDashboard) {
        try {
            const parsed = JSON.parse(dadosDashboard);
            
            // Preencher campos b√°sicos
            if (parsed.nome) document.getElementById('nome-pc').value = parsed.nome;
            if (parsed.idade) document.getElementById('idade-pc').value = parsed.idade;
            if (parsed.raca) document.getElementById('raca-pc').value = parsed.raca;
            if (parsed.classe) document.getElementById('classe-pc').value = parsed.classe;
            if (parsed.nivelTecnologico) document.getElementById('nt-pc').value = parsed.nivelTecnologico;
            
            // Carregar dinheiro
            if (parsed.dinheiro) {
                personagem.dinheiro = parsed.dinheiro;
            }
            
            atualizarStatusIdentidade();
        } catch (e) {
            console.error('‚ùå Erro ao carregar dados do localStorage:', e);
        }
    }
    
    // Carregar imagem do localStorage
    const imagemSalva = localStorage.getItem('personagem_imagem');
    if (imagemSalva) {
        const imagemPlaceholder = document.getElementById('imagem-placeholder');
        const imagemPreview = document.getElementById('imagem-preview');
        const btnRemoverImagem = document.getElementById('btn-remover-imagem');
        const previewImg = document.getElementById('preview-img');
        
        if (imagemPlaceholder) imagemPlaceholder.style.display = 'none';
        if (imagemPreview) imagemPreview.style.display = 'block';
        if (btnRemoverImagem) btnRemoverImagem.style.display = 'block';
        if (previewImg) previewImg.src = imagemSalva;
    }
    
    // Carregar dados dos sistemas
    carregarDadosSistemas();
}

function atualizarDisplay() {
    const pontosDisponiveis = document.getElementById('pontos-disponiveis');
    const dinheiroPc = document.getElementById('dinheiro-pc');
    
    if (pontosDisponiveis) {
        pontosDisponiveis.textContent = sistemaPontos.totalPontos;
    }
    if (dinheiroPc) {
        dinheiroPc.textContent = `$ ${personagem.dinheiro.toLocaleString('pt-BR')}`;
    }
}

// ===== FUN√á√ïES DE GERENCIAMENTO DE DADOS =====
function limparTodosDados() {
    personagem = {
        pontosDisponiveis: 150,
        dinheiro: 1000,
        dados: {},
        criadoEm: new Date().toISOString(),
        atualizadoEm: new Date().toISOString()
    };
    
    sistemaPontos.setTotalPontos(150);
    sistemaPontos.categorias = {
        atributos: 0,
        vantagens: 0,
        desvantagens: 0,
        pericias: 0,
        peculiaridades: 0,
        magias: 0
    };
    sistemaPontos.limites = {
        desvantagens: -112,
        peculiaridades: 100
    };
    sistemaPontos.atualizarTotal();
    atualizarDisplay();
    
    // Limpar localStorage
    localStorage.removeItem('personagem_dashboard');
    localStorage.removeItem('personagem_imagem');
    localStorage.removeItem('personagem_aparencia');
    localStorage.removeItem('personagem_idiomas');
    localStorage.removeItem('personagem_riqueza');
    localStorage.removeItem('personagem_em_edicao');
    localStorage.removeItem('personagem_atual_dados');
    localStorage.removeItem('personagem_atributos');
    localStorage.removeItem('gurps_atributos');
    
    // Limpar campos
    document.getElementById('nome-pc').value = '';
    document.getElementById('idade-pc').value = '25';
    document.getElementById('raca-pc').value = '';
    document.getElementById('classe-pc').value = '';
    document.getElementById('nt-pc').value = '';
    
    // Resetar ID
    const inputId = document.getElementById('id-personagem');
    if (inputId) {
        inputId.value = 'Aguardando salvamento...';
        inputId.style.color = '#888';
        inputId.style.fontStyle = 'italic';
        inputId.style.fontWeight = 'normal';
        
        const small = inputId.parentElement.querySelector('small');
        if (small) {
            small.innerHTML = `<i class="fas fa-info-circle"></i> O ID ser√° gerado automaticamente ao salvar o personagem`;
            small.style.color = '#666';
        }
    }
    
    // Limpar imagem
    const imagemPlaceholder = document.getElementById('imagem-placeholder');
    const imagemPreview = document.getElementById('imagem-preview');
    const btnRemoverImagem = document.getElementById('btn-remover-imagem');
    
    if (imagemPlaceholder) imagemPlaceholder.style.display = 'flex';
    if (imagemPreview) imagemPreview.style.display = 'none';
    if (btnRemoverImagem) btnRemoverImagem.style.display = 'none';
    
    // Limpar sistemas
    window.dadosAparencia = {
        nivel: 'comum',
        caracteristicas: [],
        visual: {
            altura: 1.70,
            peso: 70,
            corPele: 'Morena',
            corOlhos: 'Castanhos',
            corCabelo: 'Castanho',
            tipoCabelo: 'Curto'
        }
    };
    window.dadosIdiomas = {
        materno: 'Comum',
        alfabetizacao: 0,
        adicionais: []
    };
    window.dadosRiqueza = {
        nivel: 'medio'
    };
    
    // Atualizar resumos
    atualizarResumoAparencia();
    atualizarResumoIdiomas();
    atualizarResumoRiqueza();
    
    mostrarNotificacao('‚úÖ Todos os dados foram limpos com sucesso!', 'success');
}

function salvarDadosLocal() {
    const dados = {};
    const ids = ['nome-pc', 'idade-pc', 'raca-pc', 'classe-pc', 'nt-pc'];
    
    ids.forEach(id => {
        const element = document.getElementById(id);
        if (element) dados[id] = element.value;
    });
    
    localStorage.setItem('personagem_dashboard', JSON.stringify(dados));
    atualizarStatusIdentidade();
}

// ===== FUN√á√ïES DE IMAGEM =====
function carregarImagem(file) {
    if (!file || !file.type.match('image.*')) {
        mostrarNotificacao('Por favor, selecione um arquivo de imagem!', 'warning');
        return;
    }

    const reader = new FileReader();
    reader.onload = function(e) {
        const imagemPlaceholder = document.getElementById('imagem-placeholder');
        const imagemPreview = document.getElementById('imagem-preview');
        const btnRemoverImagem = document.getElementById('btn-remover-imagem');
        const previewImg = document.getElementById('preview-img');
        
        if (imagemPlaceholder) imagemPlaceholder.style.display = 'none';
        if (imagemPreview) imagemPreview.style.display = 'block';
        if (btnRemoverImagem) btnRemoverImagem.style.display = 'block';
        if (previewImg) previewImg.src = e.target.result;
        
        localStorage.setItem('personagem_imagem', e.target.result);
        mostrarNotificacao('‚úÖ Imagem do personagem carregada com sucesso!', 'success');
    };
    reader.readAsDataURL(file);
}

function removerImagem() {
    const imagemPlaceholder = document.getElementById('imagem-placeholder');
    const imagemPreview = document.getElementById('imagem-preview');
    const btnRemoverImagem = document.getElementById('btn-remover-imagem');
    const uploadImagem = document.getElementById('upload-imagem');
    
    if (imagemPlaceholder) imagemPlaceholder.style.display = 'flex';
    if (imagemPreview) imagemPreview.style.display = 'none';
    if (btnRemoverImagem) btnRemoverImagem.style.display = 'none';
    if (uploadImagem) uploadImagem.value = '';
    
    localStorage.removeItem('personagem_imagem');
    mostrarNotificacao('‚úÖ Imagem removida com sucesso!', 'success');
}

// ===== EDITAR VALORES DO CABE√áALHO =====
function editarValor(tipo) {
    let elemento, valorAtual, pergunta;
    
    if (tipo === 'pontos') {
        elemento = document.getElementById('pontos-disponiveis');
        valorAtual = sistemaPontos.totalPontos;
        pergunta = 'pontos totais';
    } else if (tipo === 'desvantagens') {
        elemento = document.getElementById('limite-desvantagens');
        valorAtual = sistemaPontos.limites.desvantagens;
        pergunta = 'limite de desvantagens (valor negativo)';
    } else if (tipo === 'peculiaridades') {
        elemento = document.getElementById('limites-info');
        valorAtual = sistemaPontos.limites.peculiaridades;
        pergunta = 'limite de peculiaridades';
    } else {
        elemento = document.getElementById('dinheiro-pc');
        valorAtual = personagem.dinheiro;
        pergunta = 'dinheiro';
    }
    
    if (!elemento) return;
    
    const novoValor = prompt(`Digite o novo valor para ${pergunta}:`, Math.abs(valorAtual));
    
    if (novoValor !== null && novoValor.trim() !== '') {
        const valorNumerico = parseInt(novoValor) || 0;
        
        if (tipo === 'pontos') {
            if (valorNumerico < 0) {
                mostrarNotificacao('O valor deve ser positivo!', 'warning');
                return;
            }
            sistemaPontos.setTotalPontos(valorNumerico);
        } else if (tipo === 'desvantagens') {
            sistemaPontos.setLimite('desvantagens', -Math.abs(valorNumerico));
        } else if (tipo === 'peculiaridades') {
            sistemaPontos.setLimite('peculiaridades', Math.abs(valorNumerico));
        } else {
            personagem.dinheiro = valorNumerico;
        }
        
        atualizarDisplay();
        mostrarNotificacao(`‚úÖ Valor atualizado com sucesso!`, 'success');
    }
}

// ===== NOTIFICA√á√ïES =====
function mostrarNotificacao(mensagem, tipo = 'info') {
    // Criar elemento de notifica√ß√£o
    const notificacao = document.createElement('div');
    notificacao.className = 'notificacao-flutuante';
    
    const icon = tipo === 'success' ? 'fa-check-circle' :
                 tipo === 'warning' ? 'fa-exclamation-triangle' :
                 tipo === 'error' ? 'fa-times-circle' : 'fa-info-circle';
    
    notificacao.innerHTML = `
        <div class="notificacao-conteudo ${tipo}">
            <i class="fas ${icon}"></i>
            <span>${mensagem}</span>
            <button class="notificacao-fechar" onclick="this.parentElement.parentElement.remove()">
                <i class="fas fa-times"></i>
            </button>
        </div>
    `;
    
    document.body.appendChild(notificacao);
    
    // Remover ap√≥s 5 segundos
    setTimeout(() => {
        if (notificacao.parentNode) {
            notificacao.remove();
        }
    }, 5000);
}

// Adicionar estilo para notifica√ß√µes
const estiloNotificacao = document.createElement('style');
estiloNotificacao.textContent = `
.notificacao-flutuante {
    position: fixed;
    top: 80px;
    right: 20px;
    z-index: 9999;
    animation: slideIn 0.3s ease;
}

@keyframes slideIn {
    from { transform: translateX(100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
}

.notificacao-conteudo {
    background: #1a1a1a;
    border-left: 4px solid #2196F3;
    color: white;
    padding: 15px 20px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    display: flex;
    align-items: center;
    gap: 10px;
    min-width: 300px;
    max-width: 400px;
}

.notificacao-conteudo.success {
    border-left-color: #4CAF50;
}

.notificacao-conteudo.warning {
    border-left-color: #FF9800;
}

.notificacao-conteudo.error {
    border-left-color: #f44336;
}

.notificacao-conteudo i {
    font-size: 1.2rem;
}

.notificacao-conteudo.success i {
    color: #4CAF50;
}

.notificacao-conteudo.warning i {
    color: #FF9800;
}

.notificacao-conteudo.error i {
    color: #f44336;
}

.notificacao-conteudo span {
    flex: 1;
    font-weight: 500;
}

.notificacao-fechar {
    background: none;
    border: none;
    color: #888;
    cursor: pointer;
    padding: 5px;
    border-radius: 50%;
    transition: all 0.2s ease;
}

.notificacao-fechar:hover {
    background: rgba(255,255,255,0.1);
    color: white;
}
`;
document.head.appendChild(estiloNotificacao);

// ===== MODAIS =====
window.abrirModalAparencia = function() {
    const modal = document.getElementById('modal-aparencia');
    if (modal) {
        modal.style.display = 'flex';
        document.body.style.overflow = 'hidden';
        carregarModalAparencia();
    }
};

window.abrirModalIdiomas = function() {
    const modal = document.getElementById('modal-idiomas');
    if (modal) {
        modal.style.display = 'flex';
        document.body.style.overflow = 'hidden';
        carregarModalIdiomas();
    }
};

window.abrirModalRiqueza = function() {
    const modal = document.getElementById('modal-riqueza');
    if (modal) {
        modal.style.display = 'flex';
        document.body.style.overflow = 'hidden';
        carregarModalRiqueza();
    }
};

window.fecharModal = function(tipo) {
    const modal = document.getElementById(`modal-${tipo}`);
    if (modal) {
        modal.style.display = 'none';
        document.body.style.overflow = 'auto';
    }
};

// Fechar modal ao clicar fora
document.addEventListener('click', function(e) {
    if (e.target.classList.contains('dashboard-modal')) {
        e.target.style.display = 'none';
        document.body.style.overflow = 'auto';
    }
});

// Fechar modal com ESC
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        const modals = document.querySelectorAll('.dashboard-modal');
        modals.forEach(modal => {
            if (modal.style.display === 'flex') {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        });
    }
});

// ===== SISTEMA DE APAR√äNCIA =====
const niveisAparencia = {
    "horrendo": { pontos: -24, reacao: -6, descricao: "Indescritivelmente monstruoso ou repugnante" },
    "monstruoso": { pontos: -20, reacao: -5, descricao: "Horr√≠vel e obviamente anormal" },
    "hediondo": { pontos: -16, reacao: -4, descricao: "Caracter√≠stica repugnante na apar√™ncia" },
    "feio": { pontos: -8, reacao: -2, descricao: "Cabelo seboso, dentes tortos, etc." },
    "sem-atrativos": { pontos: -4, reacao: -1, descricao: "Algo antip√°tico, mas n√£o espec√≠fico" },
    "comum": { pontos: 0, reacao: 0, descricao: "Apar√™ncia padr√£o, sem modificadores" },
    "atraente": { pontos: 4, reacao: 1, descricao: "Boa apar√™ncia, +1 em testes de rea√ß√£o" },
    "elegante": { pontos: 12, reacao: { mesmoSexo: 2, outroSexo: 4 }, descricao: "Poderia entrar em concursos de beleza" },
    "muito-elegante": { pontos: 16, reacao: { mesmoSexo: 2, outroSexo: 6 }, descricao: "Poderia vencer concursos de beleza" },
    "lindo": { pontos: 20, reacao: { mesmoSexo: 2, outroSexo: 8 }, descricao: "Esp√©cime ideal, apar√™ncia divina" }
};

const caracteristicasFisicas = {
    "magro": { pontos: -5, nome: "Magro", efeito: "Peso = 67% do normal", multiplicador: 0.67 },
    "acima-peso": { pontos: -1, nome: "Acima do Peso", efeito: "Peso = 130% do normal", multiplicador: 1.3 },
    "gordo": { pontos: -3, nome: "Gordo", efeito: "Peso = 150% do normal", multiplicador: 1.5 },
    "muito-gordo": { pontos: -5, nome: "Muito Gordo", efeito: "Peso = 200% do normal", multiplicador: 2.0 },
    "nanismo": { pontos: -15, nome: "Nanismo", efeito: "Altura m√°xima: 1.32m", alturaMax: 1.32 },
    "gigantismo": { pontos: 0, nome: "Gigantismo", efeito: "MT +1, +1 Deslocamento" }
};

window.dadosAparencia = {
    nivel: 'comum',
    caracteristicas: [],
    visual: {
        altura: 1.70,
        peso: 70,
        corPele: 'Morena',
        corOlhos: 'Castanhos',
        corCabelo: 'Castanho',
        tipoCabelo: 'Curto'
    }
};

function carregarModalAparencia() {
    const containerNiveis = document.getElementById('niveis-aparencia');
    if (containerNiveis) {
        containerNiveis.innerHTML = Object.entries(niveisAparencia).map(([key, nivel]) => {
            const selecionado = key === window.dadosAparencia.nivel;
            const corPontos = nivel.pontos >= 0 ? '#27ae60' : '#e74c3c';
            const sinal = nivel.pontos >= 0 ? '+' : '';
            const icone = key === 'lindo' ? 'star' : 
                         key === 'horrendo' ? 'skull-crossbones' : 
                         key === 'monstruoso' ? 'ghost' : 'user';
            
            return `
                <div class="nivel-item ${selecionado ? 'selecionado' : ''}" 
                     onclick="selecionarNivelAparencia('${key}')">
                    <div class="nivel-header">
                        <i class="fas fa-${icone}"></i>
                        <h5>${formatarNome(key)}</h5>
                    </div>
                    <div class="nivel-pontos" style="color: ${corPontos}">
                        ${sinal}${nivel.pontos} pts
                    </div>
                    <div class="nivel-descricao">
                        ${nivel.descricao}
                    </div>
                </div>
            `;
        }).join('');
    }

    const containerCaracteristicas = document.getElementById('caracteristicas-fisicas');
    if (containerCaracteristicas) {
        containerCaracteristicas.innerHTML = Object.entries(caracteristicasFisicas).map(([key, carac]) => {
            const selecionada = window.dadosAparencia.caracteristicas.includes(key);
            const corPontos = carac.pontos >= 0 ? '#27ae60' : '#e74c3c';
            const sinal = carac.pontos >= 0 ? '+' : '';
            const icone = key.includes('gordo') ? 'weight-hanging' : 
                         key === 'nanismo' ? 'arrow-down' : 
                         key === 'gigantismo' ? 'arrow-up' : 'user-tag';
            
            return `
                <div class="nivel-item ${selecionada ? 'selecionado' : ''}" 
                     onclick="alternarCaracteristica('${key}')">
                    <div class="nivel-header">
                        <i class="fas fa-${icone}"></i>
                        <h5>${carac.nome}</h5>
                    </div>
                    <div class="nivel-pontos" style="color: ${corPontos}">
                        ${sinal}${carac.pontos} pts
                    </div>
                    <div class="nivel-descricao">
                        ${carac.efeito}
                    </div>
                </div>
            `;
        }).join('');
    }

    Object.keys(window.dadosAparencia.visual).forEach(key => {
        const element = document.getElementById(`modal-${key}`);
        if (element) element.value = window.dadosAparencia.visual[key];
    });
}

window.selecionarNivelAparencia = function(key) {
    window.dadosAparencia.nivel = key;
    carregarModalAparencia();
};

window.alternarCaracteristica = function(key) {
    const index = window.dadosAparencia.caracteristicas.indexOf(key);
    if (index === -1) {
        window.dadosAparencia.caracteristicas.push(key);
    } else {
        window.dadosAparencia.caracteristicas.splice(index, 1);
    }
    carregarModalAparencia();
};

window.salvarAparencia = function() {
    window.dadosAparencia.visual = {
        altura: parseFloat(document.getElementById('modal-altura').value) || 1.70,
        peso: parseFloat(document.getElementById('modal-peso').value) || 70,
        corPele: document.getElementById('modal-cor-pele').value,
        corOlhos: document.getElementById('modal-cor-olhos').value,
        corCabelo: document.getElementById('modal-cor-cabelo').value,
        tipoCabelo: document.getElementById('modal-tipo-cabelo').value
    };

    const nivel = niveisAparencia[window.dadosAparencia.nivel];
    const pontosCaracteristicas = window.dadosAparencia.caracteristicas.reduce((total, key) => {
        return total + (caracteristicasFisicas[key].pontos || 0);
    }, 0);
    const pontosTotais = nivel.pontos + pontosCaracteristicas;

    // Atualizar sistema de pontos
    if (pontosTotais >= 0) {
        sistemaPontos.atualizarCategoria('vantagens', pontosTotais);
    } else {
        sistemaPontos.atualizarCategoria('desvantagens', pontosTotais);
    }

    localStorage.setItem('personagem_aparencia', JSON.stringify(window.dadosAparencia));
    atualizarResumoAparencia();

    window.fecharModal('aparencia');
    mostrarNotificacao('‚úÖ Apar√™ncia salva com sucesso!', 'success');
};

function atualizarResumoAparencia() {
    if (!window.dadosAparencia) return;
    
    const nivel = niveisAparencia[window.dadosAparencia.nivel];
    if (!nivel) return;
    
    const pontosCaracteristicas = window.dadosAparencia.caracteristicas.reduce((total, key) => {
        return total + (caracteristicasFisicas[key].pontos || 0);
    }, 0);
    const pontosTotais = nivel.pontos + pontosCaracteristicas;

    const aparenciaNivel = document.getElementById('aparencia-nivel');
    const aparenciaCusto = document.getElementById('aparencia-custo');
    const aparenciaModReacao = document.getElementById('aparencia-mod-reacao');
    const alturaResumo = document.getElementById('altura-resumo');
    const pesoResumo = document.getElementById('peso-resumo');
    const caracteristicasResumo = document.getElementById('caracteristicas-resumo');
    const modAparencia = document.getElementById('mod-aparencia');
    
    if (aparenciaNivel) aparenciaNivel.textContent = formatarNome(window.dadosAparencia.nivel);
    
    if (aparenciaCusto) {
        aparenciaCusto.textContent = `Custo: ${pontosTotais >= 0 ? '+' : ''}${pontosTotais} pontos`;
        aparenciaCusto.className = pontosTotais >= 0 ? 'pontos-positivo' : 'pontos-negativo';
    }
    
    if (aparenciaModReacao) {
        let reacaoTexto = 'Rea√ß√£o: ';
        if (typeof nivel.reacao === 'object') {
            reacaoTexto += `+${nivel.reacao.outroSexo} (outro sexo), +${nivel.reacao.mesmoSexo} (mesmo sexo)`;
        } else {
            reacaoTexto += `${nivel.reacao >= 0 ? '+' : ''}${nivel.reacao}`;
        }
        aparenciaModReacao.textContent = reacaoTexto;
    }
    
    if (alturaResumo) alturaResumo.textContent = `${window.dadosAparencia.visual.altura}m`;
    if (pesoResumo) pesoResumo.textContent = `${window.dadosAparencia.visual.peso}kg`;
    if (caracteristicasResumo) {
        caracteristicasResumo.textContent = window.dadosAparencia.caracteristicas.length > 0 ? 
            window.dadosAparencia.caracteristicas.map(c => formatarNome(c)).join(', ') : 'Nenhuma';
    }
    
    if (modAparencia) {
        modAparencia.textContent = typeof nivel.reacao === 'object' ? 
            `+${nivel.reacao.outroSexo}` : `${nivel.reacao >= 0 ? '+' : ''}${nivel.reacao}`;
    }
}

// ===== SISTEMA DE IDIOMAS =====
window.dadosIdiomas = {
    materno: 'Comum',
    alfabetizacao: 0,
    adicionais: []
};

function carregarModalIdiomas() {
    const modalIdiomaMaterno = document.getElementById('modal-idioma-materno');
    if (modalIdiomaMaterno) modalIdiomaMaterno.value = window.dadosIdiomas.materno;
    
    const radioAlfabetizacao = document.querySelector(`input[name="alfabetizacao"][value="${window.dadosIdiomas.alfabetizacao}"]`);
    if (radioAlfabetizacao) radioAlfabetizacao.checked = true;
    
    atualizarListaIdiomasModal();
    atualizarPreviewIdioma();
}

function atualizarPreviewIdioma() {
    const fala = parseInt(document.getElementById('novo-idioma-fala')?.value || '6');
    const escrita = parseInt(document.getElementById('novo-idioma-escrita')?.value || '0');
    
    const pontosTotais = fala + escrita;
    
    const previewElement = document.getElementById('preview-custo-idioma');
    if (previewElement) {
        previewElement.textContent = `${pontosTotais >= 0 ? '+' : ''}${pontosTotais} pts`;
        previewElement.className = pontosTotais >= 0 ? 'pontos-positivo' : 'pontos-negativo';
    }
}

window.adicionarIdioma = function() {
    const nomeInput = document.getElementById('novo-idioma-nome');
    const falaSelect = document.getElementById('novo-idioma-fala');
    const escritaSelect = document.getElementById('novo-idioma-escrita');
    
    if (!nomeInput || !falaSelect || !escritaSelect) return;
    
    const nome = nomeInput.value.trim();
    const fala = parseInt(falaSelect.value);
    const escrita = parseInt(escritaSelect.value);

    if (!nome) {
        mostrarNotificacao('Por favor, digite um nome para o idioma!', 'warning');
        return;
    }

    if (window.dadosIdiomas.adicionais.some(i => i.nome.toLowerCase() === nome.toLowerCase())) {
        mostrarNotificacao('Este idioma j√° foi adicionado!', 'warning');
        return;
    }

    const pontosTotais = fala + escrita;

    window.dadosIdiomas.adicionais.push({
        nome: nome,
        fala: fala,
        escrita: escrita,
        pontos: pontosTotais
    });

    nomeInput.value = '';
    falaSelect.value = '6';
    escritaSelect.value = '0';

    atualizarListaIdiomasModal();
    atualizarPreviewIdioma();
    mostrarNotificacao('‚úÖ Idioma adicionado com sucesso!', 'success');
};

window.removerIdioma = function(index) {
    window.dadosIdiomas.adicionais.splice(index, 1);
    atualizarListaIdiomasModal();
    mostrarNotificacao('‚úÖ Idioma removido com sucesso!', 'success');
};

function atualizarListaIdiomasModal() {
    const container = document.getElementById('lista-idiomas-modal');
    if (!container) return;

    if (window.dadosIdiomas.adicionais.length === 0) {
        container.innerHTML = '<p style="color: #aaa; text-align: center; padding: 20px;">Nenhum idioma adicional adicionado</p>';
        return;
    }

    container.innerHTML = window.dadosIdiomas.adicionais.map((idioma, index) => {
        const nivelFala = getNivelTexto(idioma.fala, 'fala');
        const nivelEscrita = getNivelTexto(idioma.escrita, 'escrita');
        const corPontos = idioma.pontos >= 0 ? '#27ae60' : '#e74c3c';
        
        return `
            <div class="item-lista">
                <div class="item-info">
                    <h5>${idioma.nome}</h5>
                    <p>Fala: ${nivelFala} | Escrita: ${nivelEscrita}</p>
                </div>
                <div class="item-acoes">
                    <span class="item-pontos" style="color: ${corPontos}">
                        ${idioma.pontos >= 0 ? '+' : ''}${idioma.pontos}
                    </span>
                    <button class="btn-remover" onclick="removerIdioma(${index})">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            </div>
        `;
    }).join('');
}

function getNivelTexto(valor, tipo) {
    if (tipo === 'fala') {
        if (valor >= 6) return 'Nativo';
        if (valor >= 4) return 'Sotaque';
        if (valor >= 2) return 'Rudimentar';
        return 'Nenhum';
    } else {
        if (valor >= 3) return 'Nativo';
        if (valor >= 2) return 'Sotaque';
        if (valor >= 1) return 'Rudimentar';
        return 'Nenhum';
    }
}

window.salvarIdiomas = function() {
    const radioSelecionado = document.querySelector('input[name="alfabetizacao"]:checked');
    if (radioSelecionado) {
        window.dadosIdiomas.alfabetizacao = parseInt(radioSelecionado.value);
    }
    
    const modalIdiomaMaterno = document.getElementById('modal-idioma-materno');
    if (modalIdiomaMaterno) {
        window.dadosIdiomas.materno = modalIdiomaMaterno.value;
    }

    const pontosIdiomas = window.dadosIdiomas.adicionais.reduce((total, idioma) => total + idioma.pontos, 0);
    const pontosTotais = pontosIdiomas + window.dadosIdiomas.alfabetizacao;

    // Atualizar sistema de pontos
    if (window.dadosIdiomas.alfabetizacao < 0) {
        sistemaPontos.atualizarCategoria('desvantagens', window.dadosIdiomas.alfabetizacao);
    }
    
    if (pontosIdiomas > 0) {
        sistemaPontos.atualizarCategoria('vantagens', pontosIdiomas);
    }

    localStorage.setItem('personagem_idiomas', JSON.stringify(window.dadosIdiomas));
    atualizarResumoIdiomas();

    window.fecharModal('idiomas');
    mostrarNotificacao('‚úÖ Idiomas salvos com sucesso!', 'success');
};

function atualizarResumoIdiomas() {
    if (!window.dadosIdiomas) return;
    
    const idiomaPrincipalTexto = document.getElementById('idioma-principal-texto');
    const totalIdiomas = document.getElementById('total-idiomas');
    const alfabetizacaoTexto = document.getElementById('alfabetizacao-texto');
    const listaResumo = document.getElementById('lista-idiomas-resumo');
    
    if (idiomaPrincipalTexto) idiomaPrincipalTexto.textContent = window.dadosIdiomas.materno;
    if (totalIdiomas) totalIdiomas.textContent = `${window.dadosIdiomas.adicionais.length} adicionais`;
    
    if (alfabetizacaoTexto) {
        const textoAlfabetizacao = window.dadosIdiomas.alfabetizacao === 0 ? 'Alfabetizado' : 
                                  window.dadosIdiomas.alfabetizacao === -5 ? 'Semianalfabeto' : 'Analfabeto';
        alfabetizacaoTexto.textContent = textoAlfabetizacao;
    }

    if (listaResumo) {
        if (window.dadosIdiomas.adicionais.length === 0) {
            listaResumo.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-comment-slash"></i>
                    <p>Nenhum idioma adicional</p>
                </div>
            `;
        } else {
            listaResumo.innerHTML = window.dadosIdiomas.adicionais.map(idioma => `
                <div style="padding: 5px 0; border-bottom: 1px solid rgba(212,175,55,0.1);">
                    <small><strong>${idioma.nome}</strong> - Fala: ${getNivelTexto(idioma.fala, 'fala')}, Escrita: ${getNivelTexto(idioma.escrita, 'escrita')} 
                    <span style="color: ${idioma.pontos >= 0 ? '#27ae60' : '#e74c3c'}">(${idioma.pontos >= 0 ? '+' : ''}${idioma.pontos})</span></small>
                </div>
            `).join('');
        }
    }
}

// ===== SISTEMA DE RIQUEZA =====
const niveisRiqueza = {
    "falido": { pontos: -25, multiplicador: 0, rendaBase: 0, descricao: "Sem emprego, fonte de renda, dinheiro ou bens", recursos: "Nenhum" },
    "pobre": { pontos: -15, multiplicador: 0.2, rendaBase: 200, descricao: "1/5 da riqueza m√©dia da sociedade", recursos: "Muito limitados" },
    "batalhador": { pontos: -10, multiplicador: 0.5, rendaBase: 500, descricao: "Metade da riqueza m√©dia", recursos: "Limitados" },
    "medio": { pontos: 0, multiplicador: 1, rendaBase: 1000, descricao: "N√≠vel de recursos pr√©-definido padr√£o", recursos: "Padr√£o" },
    "confortavel": { pontos: 10, multiplicador: 2, rendaBase: 2000, descricao: "O dobro da riqueza m√©dia", recursos: "Confort√°veis" },
    "rico": { pontos: 20, multiplicador: 5, rendaBase: 5000, descricao: "5 vezes a riqueza m√©dia", recursos: "Abundantes" },
    "muito-rico": { pontos: 30, multiplicador: 20, rendaBase: 20000, descricao: "20 vezes a riqueza m√©dia", recursos: "Extremamente abundantes" },
    "podre-rico": { pontos: 50, multiplicador: 100, rendaBase: 100000, descricao: "100 vezes a riqueza m√©dia", recursos: "Ilimitados para necessidades comuns" }
};

window.dadosRiqueza = {
    nivel: 'medio'
};

function carregarModalRiqueza() {
    const container = document.getElementById('niveis-riqueza');
    if (container) {
        container.innerHTML = Object.entries(niveisRiqueza).map(([key, nivel]) => {
            const selecionado = key === window.dadosRiqueza.nivel;
            const corPontos = nivel.pontos >= 0 ? '#27ae60' : '#e74c3c';
            const sinal = nivel.pontos >= 0 ? '+' : '';
            const icone = key.includes('rico') ? 'gem' : 
                         key === 'falido' ? 'skull-crossbones' : 
                         key === 'pobre' ? 'house-damage' : 'coins';
            
            return `
                <div class="nivel-item ${selecionado ? 'selecionado' : ''}" 
                     onclick="selecionarRiqueza('${key}')">
                    <div class="nivel-header">
                        <i class="fas fa-${icone}"></i>
                        <h5>${formatarNome(key)}</h5>
                    </div>
                    <div class="nivel-pontos" style="color: ${corPontos}">
                        ${sinal}${nivel.pontos} pts
                    </div>
                    <div class="nivel-descricao">
                        Multiplicador: ${nivel.multiplicador}x | Renda: $${nivel.rendaBase.toLocaleString()}
                    </div>
                </div>
            `;
        }).join('');
    }

    atualizarDetalhesRiqueza();
}

window.selecionarRiqueza = function(key) {
    window.dadosRiqueza.nivel = key;
    carregarModalRiqueza();
};

function atualizarDetalhesRiqueza() {
    const nivel = niveisRiqueza[window.dadosRiqueza.nivel];
    const container = document.getElementById('detalhes-riqueza');
    
    if (container && nivel) {
        const corPontos = nivel.pontos >= 0 ? '#27ae60' : '#e74c3c';
        const sinal = nivel.pontos >= 0 ? '+' : '';
        
        container.innerHTML = `
            <h5 style="color: #FFD700; margin-bottom: 10px;">${formatarNome(window.dadosRiqueza.nivel)}</h5>
            <p style="color: #aaa; margin-bottom: 8px;">${nivel.descricao}</p>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-top: 15px;">
                <div>
                    <small style="color: #888;">Pontos</small>
                    <div style="color: ${corPontos}; font-weight: bold;">
                        ${sinal}${nivel.pontos}
                    </div>
                </div>
                <div>
                    <small style="color: #888;">Multiplicador</small>
                    <div style="color: #FFD700; font-weight: bold;">${nivel.multiplicador}x</div>
                </div>
                <div>
                    <small style="color: #888;">Renda Mensal</small>
                    <div style="color: white; font-weight: bold;">$${nivel.rendaBase.toLocaleString()}</div>
                </div>
                <div>
                    <small style="color: #888;">Recursos</small>
                    <div style="color: white; font-weight: bold;">${nivel.recursos}</div>
                </div>
            </div>
        `;
    }
}

window.salvarRiqueza = function() {
    const nivel = niveisRiqueza[window.dadosRiqueza.nivel];

    // Atualizar sistema de pontos
    if (nivel.pontos >= 0) {
        sistemaPontos.atualizarCategoria('vantagens', nivel.pontos);
    } else {
        sistemaPontos.atualizarCategoria('desvantagens', nivel.pontos);
    }

    personagem.dinheiro = nivel.rendaBase;
    atualizarDisplay();

    localStorage.setItem('personagem_riqueza', JSON.stringify(window.dadosRiqueza));
    atualizarResumoRiqueza();

    window.fecharModal('riqueza');
    mostrarNotificacao('‚úÖ N√≠vel de riqueza salvo com sucesso!', 'success');
};

function atualizarResumoRiqueza() {
    if (!window.dadosRiqueza) return;
    
    const nivel = niveisRiqueza[window.dadosRiqueza.nivel];
    if (!nivel) return;
    
    const nivelRiquezaTexto = document.getElementById('nivel-riqueza-texto');
    const pontosRiqueza = document.getElementById('pontos-riqueza');
    const multiplicadorRiqueza = document.getElementById('multiplicador-riqueza');
    const dinheiroInicial = document.getElementById('dinheiro-inicial');
    const recursosRiqueza = document.getElementById('recursos-riqueza');
    const rendaMensal = document.getElementById('renda-mensal');
    const rendaMensalTexto = document.getElementById('renda-mensal-texto');
    
    if (nivelRiquezaTexto) nivelRiquezaTexto.textContent = formatarNome(window.dadosRiqueza.nivel);
    
    if (pontosRiqueza) {
        pontosRiqueza.textContent = `${nivel.pontos >= 0 ? '+' : ''}${nivel.pontos} pontos`;
        pontosRiqueza.className = `modifier-badge ${nivel.pontos >= 0 ? 'custo-positivo' : 'custo-negativo'}`;
    }
    
    if (multiplicadorRiqueza) multiplicadorRiqueza.textContent = `Multiplicador: ${nivel.multiplicador}x`;
    if (dinheiroInicial) dinheiroInicial.textContent = `$${nivel.rendaBase.toLocaleString()}`;
    if (recursosRiqueza) recursosRiqueza.textContent = nivel.recursos;
    if (rendaMensal) rendaMensal.textContent = `$${nivel.rendaBase.toLocaleString()}`;
    if (rendaMensalTexto) rendaMensalTexto.textContent = `Renda: $${nivel.rendaBase.toLocaleString()}`;
}

// ===== FUN√á√ïES AUXILIARES =====
function formatarNome(key) {
    return key.split('-')
        .map(palavra => palavra.charAt(0).toUpperCase() + palavra.slice(1))
        .join(' ');
}

function carregarDadosSistemas() {
    // Carregar apar√™ncia
    const aparenciaSalva = localStorage.getItem('personagem_aparencia');
    if (aparenciaSalva) {
        try {
            window.dadosAparencia = JSON.parse(aparenciaSalva);
            atualizarResumoAparencia();
        } catch (e) {
            console.error('‚ùå Erro ao carregar apar√™ncia:', e);
        }
    }

    // Carregar idiomas
    const idiomasSalvos = localStorage.getItem('personagem_idiomas');
    if (idiomasSalvos) {
        try {
            window.dadosIdiomas = JSON.parse(idiomasSalvos);
            atualizarResumoIdiomas();
        } catch (e) {
            console.error('‚ùå Erro ao carregar idiomas:', e);
        }
    }

    // Carregar riqueza
    const riquezaSalva = localStorage.getItem('personagem_riqueza');
    if (riquezaSalva) {
        try {
            window.dadosRiqueza = JSON.parse(riquezaSalva);
            atualizarResumoRiqueza();
        } catch (e) {
            console.error('‚ùå Erro ao carregar riqueza:', e);
        }
    }
}

// ===== LOGOUT =====
window.fazerLogout = async function() {
    try {
        const { signOut } = await import("https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js");
        await signOut(auth);
        window.location.href = 'login.html';
    } catch (error) {
        mostrarNotificacao('‚ùå Erro ao fazer logout: ' + error.message, 'error');
    }
};

// ===== INICIALIZA√á√ÉO DOS ATRIBUTOS =====
// Esta fun√ß√£o ser√° chamada quando a aba de atributos for aberta
window.initAtributosTab = function() {
    console.log('üéØ Iniciando aba de atributos');
    
    // Verificar se os elementos existem
    const checkElements = setInterval(() => {
        if (document.getElementById('ST')) {
            clearInterval(checkElements);
            
            // Se houver fun√ß√£o de inicializa√ß√£o dos atributos, cham√°-la
            if (window.inicializarAtributos && typeof window.inicializarAtributos === 'function') {
                window.inicializarAtributos();
            } else {
                console.log('‚ö†Ô∏è Fun√ß√£o de inicializa√ß√£o dos atributos n√£o encontrada');
            }
        }
    }, 100);
};

console.log('‚úÖ Sistema principal carregado');
</script>
</body>
</html>